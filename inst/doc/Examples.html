<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Examples</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Examples</h1>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>Author: Yong-Han Hank Cheng</p>
<p>This package allows you to generate and compare power spectral density (PSD) plots given time series data. FFT is used to take a time series data, analyze the oscillations, and then output the frequencies of these oscillations in the time series in the form of a PSD plot.</p>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Install the package from GitHub</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># devtools::install_github(&quot;yhhc2/psdr&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Load package</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">library</span>(<span class="st">&quot;psdr&quot;</span>)</span></code></pre></div>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<p>All functions with example code is run in this section. The functions are listed below in alphabetical order with example code to illustrate how each function should be used. The example code should be very similar to the example code in the function reference.</p>
<p>To see detailed descriptions for each function, please visit the packageâ€™s website.</p>
<div id="automatedcompositeplotting" class="section level3">
<h3>AutomatedCompositePlotting()</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">#I want to create a plot that shows two curves:</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#1. Composite of time series signals 1, 2, and 3.</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#2. Composite of time series signals 3 and 4.</span></span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#Create a vector of time that represent times where data are sampled.</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>Fs =<span class="st"> </span><span class="dv">100</span>; <span class="co">#sampling frequency in Hz</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>T =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>Fs; <span class="co">#sampling period</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>L =<span class="st"> </span><span class="dv">1000</span>; <span class="co">#length of time vector</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>t =<span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(L<span class="dv">-1</span>))<span class="op">*</span>T; <span class="co">#time vector</span></span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#First signal</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#1. 1 Hz with amplitude of 2</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>S1 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t)</span>
<span id="cb3-14"><a href="#cb3-14"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S1))</span>
<span id="cb3-15"><a href="#cb3-15"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="kw">length</span>(S1))</span>
<span id="cb3-16"><a href="#cb3-16"></a>S1.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S1, level1.vals, level2.vals))</span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="kw">colnames</span>(S1.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb3-18"><a href="#cb3-18"></a>S1.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S1.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb3-19"><a href="#cb3-19"></a></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co">#Second signal</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">#1. 1 Hz with amplitude of -4</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">#2. 2 Hz with amplitude of -2</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>S2 &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">4</span>)<span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">2</span><span class="op">*</span>t);</span>
<span id="cb3-24"><a href="#cb3-24"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S2))</span>
<span id="cb3-25"><a href="#cb3-25"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="kw">length</span>(S2))</span>
<span id="cb3-26"><a href="#cb3-26"></a>S2.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S2, level1.vals, level2.vals))</span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="kw">colnames</span>(S2.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb3-28"><a href="#cb3-28"></a>S2.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S2.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb3-29"><a href="#cb3-29"></a></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="co">#Third signal</span></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="co">#1. 1 Hz with amplitude of 2</span></span>
<span id="cb3-32"><a href="#cb3-32"></a><span class="co">#2. 2 Hz with amplitude of 2</span></span>
<span id="cb3-33"><a href="#cb3-33"></a>S3 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">2</span><span class="op">*</span>t);</span>
<span id="cb3-34"><a href="#cb3-34"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S3))</span>
<span id="cb3-35"><a href="#cb3-35"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;3&quot;</span>, <span class="kw">length</span>(S3))</span>
<span id="cb3-36"><a href="#cb3-36"></a>S3.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S3, level1.vals, level2.vals))</span>
<span id="cb3-37"><a href="#cb3-37"></a><span class="kw">colnames</span>(S3.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb3-38"><a href="#cb3-38"></a>S3.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S3.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb3-39"><a href="#cb3-39"></a></span>
<span id="cb3-40"><a href="#cb3-40"></a><span class="co">#Fourth signal</span></span>
<span id="cb3-41"><a href="#cb3-41"></a><span class="co">#1. 1 Hz with amplitude of -2</span></span>
<span id="cb3-42"><a href="#cb3-42"></a>S4 &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t)</span>
<span id="cb3-43"><a href="#cb3-43"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;b&quot;</span>, <span class="kw">length</span>(S4))</span>
<span id="cb3-44"><a href="#cb3-44"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;3&quot;</span>, <span class="kw">length</span>(S4))</span>
<span id="cb3-45"><a href="#cb3-45"></a>S4.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S4, level1.vals, level2.vals))</span>
<span id="cb3-46"><a href="#cb3-46"></a><span class="kw">colnames</span>(S4.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb3-47"><a href="#cb3-47"></a>S4.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S4.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb3-48"><a href="#cb3-48"></a></span>
<span id="cb3-49"><a href="#cb3-49"></a>windows &lt;-<span class="st"> </span><span class="kw">list</span>(S1.data.frame, S2.data.frame, S3.data.frame, S4.data.frame)</span>
<span id="cb3-50"><a href="#cb3-50"></a></span>
<span id="cb3-51"><a href="#cb3-51"></a><span class="co">#Gets the composite of the first, second, and third signal. Should result in a flat signal.</span></span>
<span id="cb3-52"><a href="#cb3-52"></a>FirstComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) )</span>
<span id="cb3-53"><a href="#cb3-53"></a></span>
<span id="cb3-54"><a href="#cb3-54"></a><span class="co">#Gets the composite of the third and fourth signal</span></span>
<span id="cb3-55"><a href="#cb3-55"></a>SecondComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="kw">c</span>(<span class="dv">3</span>) )</span>
<span id="cb3-56"><a href="#cb3-56"></a></span>
<span id="cb3-57"><a href="#cb3-57"></a></span>
<span id="cb3-58"><a href="#cb3-58"></a><span class="co">#Timeseries-----------------------------------------------------------------</span></span>
<span id="cb3-59"><a href="#cb3-59"></a></span>
<span id="cb3-60"><a href="#cb3-60"></a>timeseries.results &lt;-<span class="st"> </span><span class="kw">AutomatedCompositePlotting</span>(<span class="dt">list.of.windows =</span> windows,</span>
<span id="cb3-61"><a href="#cb3-61"></a>                           <span class="dt">name.of.col.containing.time.series =</span> <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb3-62"><a href="#cb3-62"></a>                           <span class="dt">x_start =</span> <span class="dv">0</span>,</span>
<span id="cb3-63"><a href="#cb3-63"></a>                           <span class="dt">x_end =</span> <span class="dv">999</span>,</span>
<span id="cb3-64"><a href="#cb3-64"></a>                           <span class="dt">x_increment =</span> <span class="dv">1</span>,</span>
<span id="cb3-65"><a href="#cb3-65"></a>                           <span class="dt">level1.column.name =</span> <span class="st">&quot;level1.ID&quot;</span>,</span>
<span id="cb3-66"><a href="#cb3-66"></a>                           <span class="dt">level2.column.name =</span> <span class="st">&quot;level2.ID&quot;</span>,</span>
<span id="cb3-67"><a href="#cb3-67"></a>                           <span class="dt">level.combinations =</span> <span class="kw">list</span>(FirstComboToUse, SecondComboToUse),</span>
<span id="cb3-68"><a href="#cb3-68"></a>                           <span class="dt">level.combinations.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Signal 1 + 2 + 3&quot;</span>, <span class="st">&quot;Signal 3 + 4&quot;</span>),</span>
<span id="cb3-69"><a href="#cb3-69"></a>                           <span class="dt">plot.title =</span> <span class="st">&quot;Example&quot;</span>,</span>
<span id="cb3-70"><a href="#cb3-70"></a>                           <span class="dt">plot.xlab =</span> <span class="st">&quot;Time&quot;</span>,</span>
<span id="cb3-71"><a href="#cb3-71"></a>                           <span class="dt">plot.ylab =</span> <span class="st">&quot;Original units&quot;</span>,</span>
<span id="cb3-72"><a href="#cb3-72"></a>                           <span class="dt">combination.index.for.envelope =</span> <span class="ot">NULL</span>,</span>
<span id="cb3-73"><a href="#cb3-73"></a>                           <span class="dt">TimeSeries.PSD.LogPSD =</span> <span class="st">&quot;TimeSeries&quot;</span>,</span>
<span id="cb3-74"><a href="#cb3-74"></a>                           <span class="dt">sampling_frequency =</span> <span class="ot">NULL</span>)</span>
<span id="cb3-75"><a href="#cb3-75"></a></span>
<span id="cb3-76"><a href="#cb3-76"></a>ggplot.obj.timeseries &lt;-<span class="st"> </span>timeseries.results[[<span class="dv">2</span>]]</span>
<span id="cb3-77"><a href="#cb3-77"></a></span>
<span id="cb3-78"><a href="#cb3-78"></a><span class="co">#Plot. Will see the 1+2+3 curve as a flat line. The 3+4 curve will only have 2 Hz.</span></span>
<span id="cb3-79"><a href="#cb3-79"></a><span class="co">#dev.new()</span></span>
<span id="cb3-80"><a href="#cb3-80"></a>ggplot.obj.timeseries</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#PSD-------------------------------------------------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#Note that the PSDs are not generated directly from the &quot;Signal 1 + 2 + 3&quot; and</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#the &quot;Signal 3 + 4&quot; time series. Instead, PSDs are generated individually</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#for signals 1, 2, 3, and 4, and then then are summed together. </span></span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a>PSD.results &lt;-<span class="st"> </span><span class="kw">AutomatedCompositePlotting</span>(<span class="dt">list.of.windows =</span> windows,</span>
<span id="cb4-8"><a href="#cb4-8"></a>                           <span class="dt">name.of.col.containing.time.series =</span> <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a>                           <span class="dt">x_start =</span> <span class="dv">0</span>,</span>
<span id="cb4-10"><a href="#cb4-10"></a>                           <span class="dt">x_end =</span> <span class="dv">50</span>,</span>
<span id="cb4-11"><a href="#cb4-11"></a>                           <span class="dt">x_increment =</span> <span class="fl">0.01</span>,</span>
<span id="cb4-12"><a href="#cb4-12"></a>                           <span class="dt">level1.column.name =</span> <span class="st">&quot;level1.ID&quot;</span>,</span>
<span id="cb4-13"><a href="#cb4-13"></a>                           <span class="dt">level2.column.name =</span> <span class="st">&quot;level2.ID&quot;</span>,</span>
<span id="cb4-14"><a href="#cb4-14"></a>                           <span class="dt">level.combinations =</span> <span class="kw">list</span>(FirstComboToUse, SecondComboToUse),</span>
<span id="cb4-15"><a href="#cb4-15"></a>                           <span class="dt">level.combinations.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Signal 1 + 2 + 3&quot;</span>, <span class="st">&quot;Signal 3 + 4&quot;</span>),</span>
<span id="cb4-16"><a href="#cb4-16"></a>                           <span class="dt">plot.title =</span> <span class="st">&quot;Example&quot;</span>,</span>
<span id="cb4-17"><a href="#cb4-17"></a>                           <span class="dt">plot.xlab =</span> <span class="st">&quot;Hz&quot;</span>,</span>
<span id="cb4-18"><a href="#cb4-18"></a>                           <span class="dt">plot.ylab =</span> <span class="st">&quot;(Original units)^2/Hz&quot;</span>,</span>
<span id="cb4-19"><a href="#cb4-19"></a>                           <span class="dt">combination.index.for.envelope =</span> <span class="dv">2</span>,</span>
<span id="cb4-20"><a href="#cb4-20"></a>                           <span class="dt">TimeSeries.PSD.LogPSD =</span> <span class="st">&quot;PSD&quot;</span>,</span>
<span id="cb4-21"><a href="#cb4-21"></a>                           <span class="dt">sampling_frequency =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>ggplot.obj.PSD &lt;-<span class="st"> </span>PSD.results[[<span class="dv">2</span>]]</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#Plot. For both plots, two peaks will be present, 1 Hz and 2 Hz. 1 Hz should be</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#stronger in both cases because more signals have this frequency (even if amp is negative).</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#Error envelope is specified for the second (red) curve. Envelope should only</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#be present for 2 Hz signal.</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#dev.new()</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>ggplot.obj.PSD</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a> <span class="co">#PSD Zoomed in---------------------------------------------------------------</span></span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a> PSD.results &lt;-<span class="st"> </span><span class="kw">AutomatedCompositePlotting</span>(<span class="dt">list.of.windows =</span> windows,</span>
<span id="cb7-4"><a href="#cb7-4"></a>                            <span class="dt">name.of.col.containing.time.series =</span> <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb7-5"><a href="#cb7-5"></a>                            <span class="dt">x_start =</span> <span class="dv">0</span>,</span>
<span id="cb7-6"><a href="#cb7-6"></a>                            <span class="dt">x_end =</span> <span class="dv">5</span>,</span>
<span id="cb7-7"><a href="#cb7-7"></a>                            <span class="dt">x_increment =</span> <span class="fl">0.01</span>,</span>
<span id="cb7-8"><a href="#cb7-8"></a>                            <span class="dt">level1.column.name =</span> <span class="st">&quot;level1.ID&quot;</span>,</span>
<span id="cb7-9"><a href="#cb7-9"></a>                            <span class="dt">level2.column.name =</span> <span class="st">&quot;level2.ID&quot;</span>,</span>
<span id="cb7-10"><a href="#cb7-10"></a>                            <span class="dt">level.combinations =</span> <span class="kw">list</span>(FirstComboToUse, SecondComboToUse),</span>
<span id="cb7-11"><a href="#cb7-11"></a>                            <span class="dt">level.combinations.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Signal 1 + 2 + 3&quot;</span>, <span class="st">&quot;Signal 3 + 4&quot;</span>),</span>
<span id="cb7-12"><a href="#cb7-12"></a>                            <span class="dt">plot.title =</span> <span class="st">&quot;Example&quot;</span>,</span>
<span id="cb7-13"><a href="#cb7-13"></a>                            <span class="dt">plot.xlab =</span> <span class="st">&quot;Hz&quot;</span>,</span>
<span id="cb7-14"><a href="#cb7-14"></a>                            <span class="dt">plot.ylab =</span> <span class="st">&quot;(Original units)^2/Hz&quot;</span>,</span>
<span id="cb7-15"><a href="#cb7-15"></a>                            <span class="dt">combination.index.for.envelope =</span> <span class="dv">2</span>,</span>
<span id="cb7-16"><a href="#cb7-16"></a>                            <span class="dt">TimeSeries.PSD.LogPSD =</span> <span class="st">&quot;PSD&quot;</span>,</span>
<span id="cb7-17"><a href="#cb7-17"></a>                            <span class="dt">sampling_frequency =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a> ggplot.obj.PSD &lt;-<span class="st"> </span>PSD.results[[<span class="dv">2</span>]]</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a> <span class="co">#Plot. For both plots, two peaks will be present, 1 Hz and 2 Hz. 1 Hz should be</span></span>
<span id="cb9-4"><a href="#cb9-4"></a> <span class="co">#stronger in both cases because more signals have this frequency (even if amp is negative).</span></span>
<span id="cb9-5"><a href="#cb9-5"></a> <span class="co">#Error envelope is specified for the second (red) curve. Envelope should only</span></span>
<span id="cb9-6"><a href="#cb9-6"></a> <span class="co">#be present for 2 Hz signal.</span></span>
<span id="cb9-7"><a href="#cb9-7"></a> <span class="co">#dev.new()</span></span>
<span id="cb9-8"><a href="#cb9-8"></a> ggplot.obj.PSD</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">#LogPSD-------------------------------------------------------------------------</span></span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a>LogPSD.results &lt;-<span class="st"> </span><span class="kw">AutomatedCompositePlotting</span>(<span class="dt">list.of.windows =</span> windows,</span>
<span id="cb10-4"><a href="#cb10-4"></a>                           <span class="dt">name.of.col.containing.time.series =</span> <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5"></a>                           <span class="dt">x_start =</span> <span class="dv">0</span>,</span>
<span id="cb10-6"><a href="#cb10-6"></a>                           <span class="dt">x_end =</span> <span class="dv">50</span>,</span>
<span id="cb10-7"><a href="#cb10-7"></a>                           <span class="dt">x_increment =</span> <span class="fl">0.01</span>,</span>
<span id="cb10-8"><a href="#cb10-8"></a>                           <span class="dt">level1.column.name =</span> <span class="st">&quot;level1.ID&quot;</span>,</span>
<span id="cb10-9"><a href="#cb10-9"></a>                           <span class="dt">level2.column.name =</span> <span class="st">&quot;level2.ID&quot;</span>,</span>
<span id="cb10-10"><a href="#cb10-10"></a>                           <span class="dt">level.combinations =</span> <span class="kw">list</span>(FirstComboToUse, SecondComboToUse),</span>
<span id="cb10-11"><a href="#cb10-11"></a>                           <span class="dt">level.combinations.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Signal 1 + 2 + 3&quot;</span>, <span class="st">&quot;Signal 3 + 4&quot;</span>),</span>
<span id="cb10-12"><a href="#cb10-12"></a>                           <span class="dt">plot.title =</span> <span class="st">&quot;Example&quot;</span>,</span>
<span id="cb10-13"><a href="#cb10-13"></a>                           <span class="dt">plot.xlab =</span> <span class="st">&quot;Hz&quot;</span>,</span>
<span id="cb10-14"><a href="#cb10-14"></a>                           <span class="dt">plot.ylab =</span> <span class="st">&quot;log((Original units)^2/Hz)&quot;</span>,</span>
<span id="cb10-15"><a href="#cb10-15"></a>                           <span class="dt">combination.index.for.envelope =</span> <span class="ot">NULL</span>,</span>
<span id="cb10-16"><a href="#cb10-16"></a>                           <span class="dt">TimeSeries.PSD.LogPSD =</span> <span class="st">&quot;LogPSD&quot;</span>,</span>
<span id="cb10-17"><a href="#cb10-17"></a>                           <span class="dt">sampling_frequency =</span> <span class="dv">100</span>)</span>
<span id="cb10-18"><a href="#cb10-18"></a></span>
<span id="cb10-19"><a href="#cb10-19"></a>ggplot.obj.LogPSD &lt;-<span class="st"> </span>LogPSD.results[[<span class="dv">2</span>]]</span>
<span id="cb10-20"><a href="#cb10-20"></a></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="co">#Plot. For both plots, two peaks will be present, 1 Hz and 2 Hz. 1 Hz should</span></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="co">#be stronger in both cases because more signals have this frequency (even if amp is negative).</span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co">#Error envelope is specified for the second (red) curve. Envelope should only</span></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co">#be present for 1 Hz signal.</span></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="co">#dev.new()</span></span>
<span id="cb10-26"><a href="#cb10-26"></a>ggplot.obj.LogPSD</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">#Are dominant frequencies different---------------------------------------------</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>comparison_results &lt;-<span class="st"> </span>PSD.results[[<span class="dv">3</span>]]</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#Table used for statistical testing</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>comparison_results[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>##   vals.to.compare.combined combo.labels.combined
## 1                        1           Signal1+2+3
## 2                        1           Signal1+2+3
## 3                        2           Signal1+2+3
## 4                        2             Signal3+4
## 5                        1             Signal3+4</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">#Kruskal Wallis results</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>comparison_results[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  vals.to.compare.combined by combo.labels.combined
## Kruskal-Wallis chi-squared = 0.11111, df = 1, p-value = 0.7389</code></pre>
</div>
<div id="countwindows" class="section level3">
<h3>CountWindows()</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">#Example using a dataframe with 5 homogeneous windows.</span></span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">#Windows are homogeneous if looking at col.two and col.three values.</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>window.name.column &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">50</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a>col.two &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb15-6"><a href="#cb15-6"></a>col.three &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a>multi.window.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(window.name.column, col.two, col.three)</span>
<span id="cb15-9"><a href="#cb15-9"></a></span>
<span id="cb15-10"><a href="#cb15-10"></a>list.of.homogeneous.windows &lt;-<span class="st"> </span><span class="kw">GetHomogeneousWindows</span>(multi.window.data,</span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="st">&quot;window.name.column&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;col.two&quot;</span>, <span class="st">&quot;col.three&quot;</span>))</span>
<span id="cb15-12"><a href="#cb15-12"></a></span>
<span id="cb15-13"><a href="#cb15-13"></a>matrix &lt;-<span class="st"> </span><span class="kw">CountWindows</span>(list.of.homogeneous.windows, <span class="st">&quot;col.two&quot;</span>, <span class="st">&quot;col.three&quot;</span>,</span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>))</span>
<span id="cb15-15"><a href="#cb15-15"></a></span>
<span id="cb15-16"><a href="#cb15-16"></a>matrix</span></code></pre></div>
<pre><code>##   1 2 3
## a 2 1 1
## b 1 0 0</code></pre>
</div>
<div id="findhomogeneouswindows" class="section level3">
<h3>FindHomogeneousWindows()</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>col.one &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>col.two &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a>col.three &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a>single.window.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(col.one, col.two, col.three)</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co">#Example of inhomogeneous window if looking at col.one and col.two because</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">#col.one does not only have a single unique value.</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>result &lt;-<span class="st"> </span><span class="kw">FindHomogeneousWindows</span>(single.window.data , <span class="kw">c</span>(<span class="st">&quot;col.one&quot;</span>, <span class="st">&quot;col.two&quot;</span>))</span>
<span id="cb17-10"><a href="#cb17-10"></a></span>
<span id="cb17-11"><a href="#cb17-11"></a>result</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">#Example of homogeneous window if looking at col.two and col.three because</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">#col.two and col.three both only have a single unique value.</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>result &lt;-<span class="st"> </span><span class="kw">FindHomogeneousWindows</span>(single.window.data , <span class="kw">c</span>(<span class="st">&quot;col.two&quot;</span>, <span class="st">&quot;col.three&quot;</span>))</span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a>result</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="gethomogeneouswindows" class="section level3">
<h3>GetHomogeneousWindows</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co">#Example using a dataframe with 3 windows.</span></span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co">#Windows 20 and 30 are homogeneous if looking at col.two and col.three values.</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>window.name.column &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">30</span>)</span>
<span id="cb21-5"><a href="#cb21-5"></a>col.two &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb21-6"><a href="#cb21-6"></a>col.three &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb21-7"><a href="#cb21-7"></a></span>
<span id="cb21-8"><a href="#cb21-8"></a>multi.window.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(window.name.column, col.two, col.three)</span>
<span id="cb21-9"><a href="#cb21-9"></a></span>
<span id="cb21-10"><a href="#cb21-10"></a>result &lt;-<span class="st"> </span><span class="kw">GetHomogeneousWindows</span>(multi.window.data, <span class="st">&quot;window.name.column&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;col.two&quot;</span>, <span class="st">&quot;col.three&quot;</span>))</span>
<span id="cb21-11"><a href="#cb21-11"></a></span>
<span id="cb21-12"><a href="#cb21-12"></a><span class="co">#As expected, it looks like two windows are homogeneous.</span></span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="kw">str</span>(result)</span></code></pre></div>
<pre><code>## List of 2
##  $ :&#39;data.frame&#39;:    3 obs. of  3 variables:
##   ..$ window.name.column: num [1:3] 20 20 20
##   ..$ col.two           : chr [1:3] &quot;a&quot; &quot;a&quot; &quot;a&quot;
##   ..$ col.three         : num [1:3] 1 1 1
##  $ :&#39;data.frame&#39;:    4 obs. of  3 variables:
##   ..$ window.name.column: num [1:4] 30 30 30 30
##   ..$ col.two           : chr [1:4] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot;
##   ..$ col.three         : num [1:4] 2 2 2 2</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>result[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>##   window.name.column col.two col.three
## 4                 20       a         1
## 5                 20       a         1
## 6                 20       a         1</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>result[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>##    window.name.column col.two col.three
## 7                  30       a         2
## 8                  30       a         2
## 9                  30       a         2
## 10                 30       a         2</code></pre>
</div>
<div id="getsubsetofwindows" class="section level3">
<h3>GetSubsetOfWindows()</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co">#Example using a dataframe with 3 windows.</span></span>
<span id="cb27-2"><a href="#cb27-2"></a></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="co">#Windows 20 and 30 are homogeneous if looking at col.two and col.three values.</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>window.name.column &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">30</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a>col.two &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb27-6"><a href="#cb27-6"></a>col.three &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb27-7"><a href="#cb27-7"></a></span>
<span id="cb27-8"><a href="#cb27-8"></a>multi.window.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(window.name.column, col.two, col.three)</span>
<span id="cb27-9"><a href="#cb27-9"></a></span>
<span id="cb27-10"><a href="#cb27-10"></a>list.of.homogeneous.windows &lt;-<span class="st"> </span><span class="kw">GetHomogeneousWindows</span>(multi.window.data,</span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="st">&quot;window.name.column&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;col.two&quot;</span>, <span class="st">&quot;col.three&quot;</span>))</span>
<span id="cb27-12"><a href="#cb27-12"></a></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co">#Get a subset of windows where col.three has a value of 2</span></span>
<span id="cb27-14"><a href="#cb27-14"></a>subset.list.of.homogeneous.windows &lt;-<span class="st"> </span><span class="kw">GetSubsetOfWindows</span>(list.of.homogeneous.windows,</span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="st">&quot;col.three&quot;</span>, <span class="st">&quot;2&quot;</span>)</span>
<span id="cb27-16"><a href="#cb27-16"></a></span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="kw">str</span>(subset.list.of.homogeneous.windows)</span></code></pre></div>
<pre><code>## List of 1
##  $ :&#39;data.frame&#39;:    4 obs. of  3 variables:
##   ..$ window.name.column: num [1:4] 30 30 30 30
##   ..$ col.two           : chr [1:4] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot;
##   ..$ col.three         : num [1:4] 2 2 2 2</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>subset.list.of.homogeneous.windows[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>##    window.name.column col.two col.three
## 7                  30       a         2
## 8                  30       a         2
## 9                  30       a         2
## 10                 30       a         2</code></pre>
</div>
<div id="getsubsetofwindowstwolevels" class="section level3">
<h3>GetSubsetOfWindowsTwoLevels()</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co">#Example using a dataframe with 5 homogeneous windows.</span></span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co">#Windows are homogeneous if looking at col.two and col.three values.</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>window.name.column &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">50</span>)</span>
<span id="cb31-5"><a href="#cb31-5"></a>col.two &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb31-6"><a href="#cb31-6"></a>col.three &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb31-7"><a href="#cb31-7"></a></span>
<span id="cb31-8"><a href="#cb31-8"></a>multi.window.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(window.name.column, col.two, col.three)</span>
<span id="cb31-9"><a href="#cb31-9"></a></span>
<span id="cb31-10"><a href="#cb31-10"></a>list.of.homogeneous.windows &lt;-<span class="st"> </span><span class="kw">GetHomogeneousWindows</span>(multi.window.data,</span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="st">&quot;window.name.column&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;col.two&quot;</span>, <span class="st">&quot;col.three&quot;</span>))</span>
<span id="cb31-12"><a href="#cb31-12"></a></span>
<span id="cb31-13"><a href="#cb31-13"></a>result &lt;-<span class="st"> </span><span class="kw">GetSubsetOfWindowsTwoLevels</span>(list.of.homogeneous.windows, <span class="st">&quot;col.two&quot;</span>, <span class="st">&quot;col.three&quot;</span>,</span>
<span id="cb31-14"><a href="#cb31-14"></a><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>))</span>
<span id="cb31-15"><a href="#cb31-15"></a></span>
<span id="cb31-16"><a href="#cb31-16"></a><span class="co">#Should contain windows 10, 20, 30 because col.two is &quot;a&quot; and col.three can be &quot;1&quot; or &quot;2&quot;</span></span>
<span id="cb31-17"><a href="#cb31-17"></a>result</span></code></pre></div>
<pre><code>## [[1]]
##   window.name.column col.two col.three
## 1                 10       a         1
## 2                 10       a         1
## 3                 10       a         1
## 
## [[2]]
##   window.name.column col.two col.three
## 4                 20       a         1
## 5                 20       a         1
## 6                 20       a         1
## 
## [[3]]
##    window.name.column col.two col.three
## 7                  30       a         2
## 8                  30       a         2
## 9                  30       a         2
## 10                 30       a         2</code></pre>
</div>
<div id="identifymaxonxy" class="section level3">
<h3>IdentifyMaxOnXY()</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co">#I want to create a plot that shows two curves:</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="co">#1. Composite of time series signals 1, 2, and 3.</span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="co">#2. Composite of time series signals 3 and 4.</span></span>
<span id="cb33-4"><a href="#cb33-4"></a></span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="co">#Create a vector of time that represent times where data are sampled.</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>Fs =<span class="st"> </span><span class="dv">100</span>; <span class="co">#sampling frequency in Hz</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>T =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>Fs; <span class="co">#sampling period</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>L =<span class="st"> </span><span class="dv">1000</span>; <span class="co">#length of time vector</span></span>
<span id="cb33-9"><a href="#cb33-9"></a>t =<span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(L<span class="dv">-1</span>))<span class="op">*</span>T; <span class="co">#time vector</span></span>
<span id="cb33-10"><a href="#cb33-10"></a></span>
<span id="cb33-11"><a href="#cb33-11"></a><span class="co">#First signal</span></span>
<span id="cb33-12"><a href="#cb33-12"></a><span class="co">#1. 1 Hz with amplitude of 2</span></span>
<span id="cb33-13"><a href="#cb33-13"></a>S1 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t)</span>
<span id="cb33-14"><a href="#cb33-14"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S1))</span>
<span id="cb33-15"><a href="#cb33-15"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="kw">length</span>(S1))</span>
<span id="cb33-16"><a href="#cb33-16"></a>S1.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S1, level1.vals, level2.vals))</span>
<span id="cb33-17"><a href="#cb33-17"></a><span class="kw">colnames</span>(S1.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb33-18"><a href="#cb33-18"></a>S1.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S1.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb33-19"><a href="#cb33-19"></a></span>
<span id="cb33-20"><a href="#cb33-20"></a><span class="co">#Second signal</span></span>
<span id="cb33-21"><a href="#cb33-21"></a><span class="co">#1. 1 Hz with amplitude of -4</span></span>
<span id="cb33-22"><a href="#cb33-22"></a><span class="co">#2. 2 Hz with amplitude of -2</span></span>
<span id="cb33-23"><a href="#cb33-23"></a>S2 &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">4</span>)<span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">2</span><span class="op">*</span>t);</span>
<span id="cb33-24"><a href="#cb33-24"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S2))</span>
<span id="cb33-25"><a href="#cb33-25"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="kw">length</span>(S2))</span>
<span id="cb33-26"><a href="#cb33-26"></a>S2.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S2, level1.vals, level2.vals))</span>
<span id="cb33-27"><a href="#cb33-27"></a><span class="kw">colnames</span>(S2.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb33-28"><a href="#cb33-28"></a>S2.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S2.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb33-29"><a href="#cb33-29"></a></span>
<span id="cb33-30"><a href="#cb33-30"></a><span class="co">#Third signal</span></span>
<span id="cb33-31"><a href="#cb33-31"></a><span class="co">#1. 1 Hz with amplitude of 2</span></span>
<span id="cb33-32"><a href="#cb33-32"></a><span class="co">#2. 2 Hz with amplitude of 2</span></span>
<span id="cb33-33"><a href="#cb33-33"></a>S3 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">2</span><span class="op">*</span>t);</span>
<span id="cb33-34"><a href="#cb33-34"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S3))</span>
<span id="cb33-35"><a href="#cb33-35"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;3&quot;</span>, <span class="kw">length</span>(S3))</span>
<span id="cb33-36"><a href="#cb33-36"></a>S3.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S3, level1.vals, level2.vals))</span>
<span id="cb33-37"><a href="#cb33-37"></a><span class="kw">colnames</span>(S3.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb33-38"><a href="#cb33-38"></a>S3.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S3.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb33-39"><a href="#cb33-39"></a></span>
<span id="cb33-40"><a href="#cb33-40"></a><span class="co">#Fourth signal</span></span>
<span id="cb33-41"><a href="#cb33-41"></a><span class="co">#1. 1 Hz with amplitude of -2</span></span>
<span id="cb33-42"><a href="#cb33-42"></a>S4 &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t)</span>
<span id="cb33-43"><a href="#cb33-43"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;b&quot;</span>, <span class="kw">length</span>(S4))</span>
<span id="cb33-44"><a href="#cb33-44"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;3&quot;</span>, <span class="kw">length</span>(S4))</span>
<span id="cb33-45"><a href="#cb33-45"></a>S4.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S4, level1.vals, level2.vals))</span>
<span id="cb33-46"><a href="#cb33-46"></a><span class="kw">colnames</span>(S4.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb33-47"><a href="#cb33-47"></a>S4.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S4.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb33-48"><a href="#cb33-48"></a></span>
<span id="cb33-49"><a href="#cb33-49"></a><span class="co">#Extra representation of S2 dataframe to show an example that has enough samples</span></span>
<span id="cb33-50"><a href="#cb33-50"></a><span class="co">#to have significance for Kruskal-Wallis test</span></span>
<span id="cb33-51"><a href="#cb33-51"></a>windows &lt;-<span class="st"> </span><span class="kw">list</span>(S1.data.frame, S2.data.frame, S2.data.frame, S2.data.frame, S2.data.frame,</span>
<span id="cb33-52"><a href="#cb33-52"></a>S2.data.frame, S2.data.frame, S2.data.frame, S2.data.frame, S2.data.frame, S3.data.frame,</span>
<span id="cb33-53"><a href="#cb33-53"></a>S4.data.frame)</span>
<span id="cb33-54"><a href="#cb33-54"></a></span>
<span id="cb33-55"><a href="#cb33-55"></a><span class="co">#Gets the composite of the first, second, and third signal. Should result in a flat signal.</span></span>
<span id="cb33-56"><a href="#cb33-56"></a>FirstComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) )</span>
<span id="cb33-57"><a href="#cb33-57"></a></span>
<span id="cb33-58"><a href="#cb33-58"></a><span class="co">#Gets the composite of the third and fourth signal</span></span>
<span id="cb33-59"><a href="#cb33-59"></a>SecondComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="kw">c</span>(<span class="dv">3</span>) )</span>
<span id="cb33-60"><a href="#cb33-60"></a></span>
<span id="cb33-61"><a href="#cb33-61"></a></span>
<span id="cb33-62"><a href="#cb33-62"></a><span class="co">#PSD-------------------------------------------------------------------------</span></span>
<span id="cb33-63"><a href="#cb33-63"></a></span>
<span id="cb33-64"><a href="#cb33-64"></a>PSD.results &lt;-<span class="st"> </span><span class="kw">AutomatedCompositePlotting</span>(<span class="dt">list.of.windows =</span> windows,</span>
<span id="cb33-65"><a href="#cb33-65"></a>                           <span class="dt">name.of.col.containing.time.series =</span> <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb33-66"><a href="#cb33-66"></a>                           <span class="dt">x_start =</span> <span class="dv">0</span>,</span>
<span id="cb33-67"><a href="#cb33-67"></a>                           <span class="dt">x_end =</span> <span class="dv">10</span>,</span>
<span id="cb33-68"><a href="#cb33-68"></a>                           <span class="dt">x_increment =</span> <span class="fl">0.01</span>,</span>
<span id="cb33-69"><a href="#cb33-69"></a>                           <span class="dt">level1.column.name =</span> <span class="st">&quot;level1.ID&quot;</span>,</span>
<span id="cb33-70"><a href="#cb33-70"></a>                           <span class="dt">level2.column.name =</span> <span class="st">&quot;level2.ID&quot;</span>,</span>
<span id="cb33-71"><a href="#cb33-71"></a>                           <span class="dt">level.combinations =</span> <span class="kw">list</span>(FirstComboToUse, SecondComboToUse),</span>
<span id="cb33-72"><a href="#cb33-72"></a>                           <span class="dt">level.combinations.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Signal 1 + 2 + 3&quot;</span>, <span class="st">&quot;Signal 3 + 4&quot;</span>),</span>
<span id="cb33-73"><a href="#cb33-73"></a>                           <span class="dt">plot.title =</span> <span class="st">&quot;Example&quot;</span>,</span>
<span id="cb33-74"><a href="#cb33-74"></a>                           <span class="dt">plot.xlab =</span> <span class="st">&quot;Hz&quot;</span>,</span>
<span id="cb33-75"><a href="#cb33-75"></a>                           <span class="dt">plot.ylab =</span> <span class="st">&quot;(Original units)^2/Hz&quot;</span>,</span>
<span id="cb33-76"><a href="#cb33-76"></a>                           <span class="dt">combination.index.for.envelope =</span> <span class="dv">2</span>,</span>
<span id="cb33-77"><a href="#cb33-77"></a>                           <span class="dt">TimeSeries.PSD.LogPSD =</span> <span class="st">&quot;PSD&quot;</span>,</span>
<span id="cb33-78"><a href="#cb33-78"></a>                           <span class="dt">sampling_frequency =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>ggplot.obj.PSD &lt;-<span class="st"> </span>PSD.results[[<span class="dv">2</span>]]</span>
<span id="cb35-2"><a href="#cb35-2"></a></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="co">#Plot</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>ggplot.obj.PSD</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABEVBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrYzMzM6AAA6ADo6AGY6OgA6OmY6OpA6ZmY6ZpA6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOjpmkNtmtttmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQZgCQZmaQkLaQtpCQttuQ29uQ2/+rbk2rbm6rbo6rjk2ryKur5OSr5P+zs7O2ZgC2kDq2tpC2ttu22/+2///Ijk3I///bkDrbtmbbtpDb29vb/7bb///kq27k///r6+vy8vL/AAD/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///9MjcyUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKG0lEQVR4nO2da3/bthWH6ajOVK1ru8rp5i5b1HV12y3qtnZOd0nVLXaYbk5TK6oVGd//gwwH4AUgKB2AokTK+D8vIoqiFfH5HRyQxC0RYCNJ1z+g70AQAwQxQBADBDFAEAMEMUAQQ3NBaZIxDPij1fT+VeP/sRMgiGELQfcuwv8oUkFpMhZiTv+8+EWSHP1OiMVo/GIkN+aj5JdXYnk6lhvH57mgnx4mybvPWvn9O6cVQavpvYvlqXyfFbuJFPT+SKr6aqSK4PKU3iVH51rQgt7Qu0Ng+xxEJzpPhqnUIkU9o+gZkoNH4kUig2oxun+1PE2GV6vvpCoStJoePRLi+1FI7uqOdgSJWZ6r//vvv4ySoZIkA0eGCylRG/Kgexf0ThY/9fdNctj+aSlJL0bKky48StCYBJG0GQlS9tKjcxI0N832npYEzSnxSCPJ+3/9z/9OIYgwBS1Pjx/Kt4uRtJTlIFsQFTFK5bqITbb/3XujHUEyNuYqIQ+vqA7P8owhKPnAStJfy6p+eudzUH4lfe+CYkbHh97jCnprpA7U1XxWxsbtncUOaUXQjNIJWaIrwOOvZ6SskoPoivFZfqG4kIe99ai9k9gle7mbz5L0QQJBDBDEAEEMeKLIAEEMEMQAQQwQxABBDI0FvZKofzTcZuihbZ7jVkAQAwQxQBADBDFAEAMEMeA6iAERxABBDO0IGkCQAwQxQBADBDFAEAMEMUAQAwQxQBADBDFAEAMEMUAQAwQxQBADBDFAEAMEMUAQAwSJN5+d/OoHc+v2ycmDp/mnEHT75LF4+Wtz6/KxeJ0pgyAZNl88FzefPC+36KUEgm4+/UG8+fxpuXXz6T+yIva2xDp2sNPf2CnrBVFp0oKyrZuPHytXGkRQTQTlOwgIcnPQnyDI5PbJWVGLneW1GIqYgb76oSDKroPky4dFRQZBDBDEEKOgbFjX3Gs4cpyCaGAyBFlYgj46nyUTCLKwI2gi0mS4eAeCSqqCaH4SRJCBI0hNoeDxhzEKCgKCGKITJOv4cjIOjz+MTpAi9Z/ED4IYIIgBghggiAGCGCCIITpBuA6qB1fSDEYEhc30HJ0gPRFrw7kN42l6Tr2nWI0wgjLwPMgCSZrBEDTLKng8tDcpBc3UNLQTCLIxqvmJ0G2HEGRSESRT9BCCTOwiJormVZb4BImZvgJCNW+Bap4BghggiAEPzBgMQWnQzXx0gpanYY86ohOkIihgyZQIBYniYtGHOAUFEKWgNGBNmfgEyZuwzEzq89g1OkHL3xh3YNabeqITFAoEuYN69ejVjCgFLU8n5eMgd1CvEC9P4hY0G9K6c6leiMcZUCfEzR/+GLUgGUCrafFM2hmSKW6/+ZcuYrEO6lUlbJwLcgb1ipdnkeeg1XQ8l1dAM13E6gb1Ri6Iui8Mi/sxJwe9PCHOsmOjFGThDuqNvprPmsbydjFnUC8E2YI2E5+gYt3UxGtBwvgEFRHkRyeCfqxnKwMMh3Wz2qUgfR/W827AiCAIOmxB1BEYRczGvhcLWHE4RkGo5muwI+jABVE1LPPDuqkj9H7zU8op5TnP67KLlYP8bjJ6K0iVgA0dVJSauSFh+dG5WPz83Pg4dZJMZfaXg07SSoA8aXqV53L82/PFe39WIaIjhfbPjr5SEaQatuakYzYxmrnc4Du0an7gUApaTXX0KBFjMT86X4zky/0rFSnvXJhFrFBCn5XvNkfQIQjanKTnaiyOVEBnvPpSxVIWFHJPKWheNLGvpuPy3WLkNinfpSKmkDmFguW9K0uQGmZRE0FZryg7ntYKWnfMoQhSKUXmFCeCKHvXFrHFSNdhZVP7rFqR1xSxuVcnIfOkBv0QpGqxLElnOUgLUi8qsoSVh3M/5Xn7RFCDJ4o9EaRyhM5BtPmzsoilSXL8cOII0s8IJ8bbzTkow6+bWR8F2fhNNcZRk6Q9x2QaDPbVsuotaDVtch51tFLN9zOC2gGCGCCIAYIYIIgBghhamf0lCkGhQBBDlIKaNvvEImg1Ha+mE8+2jRgFkZrZ+HAfd+wEZ8LtJlNT9EWQR7NPtWmHbeqqdiSXdvxG9vZQkEezj9O0k3KjLC1B9AR75vmYoIeCfJp9isP0Q9bFuw9DBIVgCXo12Jega4cfA5t9dARpQasv/xZUxA5A0OYk7dHso5p28oaedByWgxpfB/VFkPBo9jGaCuVRQYIad3/piSC/Zh+jsTn1GKLbSveXngjyaPZxmnYCI+iwBfk0+1SbdsJyUNPuL4Wgb7sVZLOzZp/EGqthbN18fFI/JLN/gvbR7OOMWaXBYze/r1vjsH+C2mO9IGe82GuydZmHUHSCnJ727phVcqVeqmNWB9dZ0+q3u/ypomcR5I5Z1UPrMqwIuo4gghxqIujNZ4WfbgR1QF0tpkeMuePmaS3jghgF0awCqleauudwxqxafqIUVA7JVFeM1TGretRzbS1WCBrEJGgzMQoqipjPfIpRCtIPkiYiDZyBqhA0uOuCAoAghugEbTOoNwpBocQoqPkTxUgENX8mHYmgkOmkoxSEJF0DkjQDBDGYglTLs29bQISC9MIji5Ff+3N8gvJHHE36KMYgiDpPaRr0MItBUBk4DfooQpBLdIJQxOppnKRNipbVwXU7v6pH1FTzfiu01EfQ9R2OoOxC0beLUK2g67stKAjzpK4hyCU6QdusqxGFIHoalFVfwSuzxCFIqO7Wjdb2iUZQCBDEYAl6dQ1BVSCIAYIYIIgBghggiAGCGCCIAYIYIIgBghggiAGCGCCIAYLcQb3lDgFBNYN6yx0EBDkD6sodBATVLSNaGdRbTFEj3FlrmrOnM/ckYFBvuYOoDYA7PuLQZkMEERAUkIPiFOQM6i13EBDkLkS79jooUkGbgSAGCGKAIAYIYmhy1hAEQSUQxABBDBDEAEEMEMQAQQwQxABBHrztv3frQ7sCghggiAGCGLYSFAMQxABBDBDEAEEMjQQ5PYcU5ZoANC3uh88rm8ahxrS55eeq0bb+m7ukiSCn55DCWBPgspxXudi0exfpHhHm56/JU/03d0oTQe5U3ES5JsDtN3kPB2PTbtnPe0EUn18++Cc14dZ+c6c0EVS7HIBCb8vSkRe2crNyaBYdxqFqzvO139wZTQTVLQegyNYEoIKWhUa5aR+ab5mHSkFrv7k72owgc00AJw/Zh742E7A+9A5F0JpMYc95XxVkJ5XLM+fQm7uTg5yeQ4rSD4XH7d+f25tW76IiNxuHko76b+6ULa6DjJ5DRHZxQ3vl5oOnxV65WTk0L0bWocZ1UPXwLsGVNAMEMUAQAwQxQBADBDHsWFC5Gs5u/5/dAUEMEMSwN0HZOtLBs3x2zV4jKGgx6Z6wc0HmQguzgGUp+sI+Iyg9xEy0R0HzdtYW3jP7E3SYfvZZix1cBabYmyA9y+fhRRHuxRggiAGCGCCIAYIYIIgBghggiAGCGCCI4f/aJCAgAQoXFwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>dataframes.plotted &lt;-<span class="st"> </span>PSD.results[[<span class="dv">1</span>]]</span>
<span id="cb36-2"><a href="#cb36-2"></a>first.curve &lt;-<span class="st"> </span>dataframes.plotted[[<span class="dv">1</span>]]</span>
<span id="cb36-3"><a href="#cb36-3"></a>second.curve &lt;-<span class="st"> </span>dataframes.plotted[[<span class="dv">2</span>]]</span>
<span id="cb36-4"><a href="#cb36-4"></a></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="co">#Identify maximum</span></span>
<span id="cb36-6"><a href="#cb36-6"></a>first.curve.max &lt;-<span class="st"> </span><span class="kw">IdentifyMaxOnXY</span>(first.curve<span class="op">$</span>xvals, first.curve<span class="op">$</span>yvals, <span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb36-7"><a href="#cb36-7"></a>second.curve.max &lt;-<span class="st"> </span><span class="kw">IdentifyMaxOnXY</span>(second.curve<span class="op">$</span>xvals, second.curve<span class="op">$</span>yvals, <span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb36-8"><a href="#cb36-8"></a></span>
<span id="cb36-9"><a href="#cb36-9"></a>first.curve.max</span></code></pre></div>
<pre><code>##     xval       yval
## 101    1 0.06909091</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>second.curve.max</span></code></pre></div>
<pre><code>##     xval yval
## 101    1 0.02</code></pre>
</div>
<div id="makecompositepsdforallwindows" class="section level3">
<h3>MakeCompositePSDForAllWindows()</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co">#Create a vector of time that represent times where data are sampled.</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>Fs =<span class="st"> </span><span class="dv">100</span>; <span class="co">#sampling frequency in Hz</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>T =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>Fs; <span class="co">#sampling period</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>L =<span class="st"> </span><span class="dv">1000</span>; <span class="co">#length of time vector</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>t =<span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(L<span class="dv">-1</span>))<span class="op">*</span>T; <span class="co">#time vector</span></span>
<span id="cb40-6"><a href="#cb40-6"></a></span>
<span id="cb40-7"><a href="#cb40-7"></a><span class="co">#First signal</span></span>
<span id="cb40-8"><a href="#cb40-8"></a><span class="co">#1. 10 Hz with amplitude of 4</span></span>
<span id="cb40-9"><a href="#cb40-9"></a><span class="co">#2. 25 Hz with amplitude of 4</span></span>
<span id="cb40-10"><a href="#cb40-10"></a>S1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">10</span><span class="op">*</span>t) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">25</span><span class="op">*</span>t);</span>
<span id="cb40-11"><a href="#cb40-11"></a>S1 &lt;-<span class="st"> </span>S1 <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">length</span>(t)) <span class="co">#Add some noise</span></span>
<span id="cb40-12"><a href="#cb40-12"></a>S1.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S1))</span>
<span id="cb40-13"><a href="#cb40-13"></a><span class="kw">colnames</span>(S1.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>)</span>
<span id="cb40-14"><a href="#cb40-14"></a></span>
<span id="cb40-15"><a href="#cb40-15"></a><span class="co">#Second signal</span></span>
<span id="cb40-16"><a href="#cb40-16"></a><span class="co">#1. 5 Hz with amplitude of 2</span></span>
<span id="cb40-17"><a href="#cb40-17"></a><span class="co">#2. 8 Hz with amplitude of 2</span></span>
<span id="cb40-18"><a href="#cb40-18"></a>S2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">5</span><span class="op">*</span>t) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">8</span><span class="op">*</span>t);</span>
<span id="cb40-19"><a href="#cb40-19"></a>S2 &lt;-<span class="st"> </span>S2 <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">length</span>(t)) <span class="co">#Add some noise</span></span>
<span id="cb40-20"><a href="#cb40-20"></a>S2.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S2))</span>
<span id="cb40-21"><a href="#cb40-21"></a><span class="kw">colnames</span>(S2.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>)</span>
<span id="cb40-22"><a href="#cb40-22"></a></span>
<span id="cb40-23"><a href="#cb40-23"></a><span class="co">#Third signal</span></span>
<span id="cb40-24"><a href="#cb40-24"></a><span class="co">#1. 5 Hz with amplitude of 2</span></span>
<span id="cb40-25"><a href="#cb40-25"></a><span class="co">#2. 8 Hz with amplitude of 2</span></span>
<span id="cb40-26"><a href="#cb40-26"></a>S3 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">5</span><span class="op">*</span>t) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">8</span><span class="op">*</span>t);</span>
<span id="cb40-27"><a href="#cb40-27"></a>S3 &lt;-<span class="st"> </span>S3 <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">length</span>(t)) <span class="co">#Add some noise</span></span>
<span id="cb40-28"><a href="#cb40-28"></a>S3.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S3))</span>
<span id="cb40-29"><a href="#cb40-29"></a><span class="kw">colnames</span>(S3.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>)</span>
<span id="cb40-30"><a href="#cb40-30"></a></span>
<span id="cb40-31"><a href="#cb40-31"></a><span class="co">#Add all signals to a List</span></span>
<span id="cb40-32"><a href="#cb40-32"></a>list.of.windows &lt;-<span class="st"> </span><span class="kw">list</span>(S1.data.frame, S2.data.frame, S3.data.frame)</span>
<span id="cb40-33"><a href="#cb40-33"></a></span>
<span id="cb40-34"><a href="#cb40-34"></a>results &lt;-<span class="st"> </span><span class="kw">MakeCompositePSDForAllWindows</span>(list.of.windows, <span class="st">&quot;Signal&quot;</span>, Fs, <span class="dv">0</span>, <span class="dv">30</span>, <span class="fl">0.1</span>)</span>
<span id="cb40-35"><a href="#cb40-35"></a></span>
<span id="cb40-36"><a href="#cb40-36"></a>frequencies &lt;-<span class="st"> </span>results[[<span class="dv">1</span>]]</span>
<span id="cb40-37"><a href="#cb40-37"></a></span>
<span id="cb40-38"><a href="#cb40-38"></a>averaged.PSD &lt;-<span class="st"> </span>results[[<span class="dv">2</span>]]</span>
<span id="cb40-39"><a href="#cb40-39"></a></span>
<span id="cb40-40"><a href="#cb40-40"></a>stddev.PSD &lt;-<span class="st"> </span>results[[<span class="dv">3</span>]]</span>
<span id="cb40-41"><a href="#cb40-41"></a></span>
<span id="cb40-42"><a href="#cb40-42"></a><span class="kw">plot</span>(frequencies, averaged.PSD, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="makecompositexyplotforallwindows" class="section level3">
<h3>MakeCompositeXYPlotForAllWindows</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co">#Create a vector of time that represent times where data are sampled.</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>Fs =<span class="st"> </span><span class="dv">100</span>; <span class="co">#sampling frequency in Hz</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>T =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>Fs; <span class="co">#sampling period</span></span>
<span id="cb41-4"><a href="#cb41-4"></a>L =<span class="st"> </span><span class="dv">1000</span>; <span class="co">#length of time vector</span></span>
<span id="cb41-5"><a href="#cb41-5"></a>t =<span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(L<span class="dv">-1</span>))<span class="op">*</span>T; <span class="co">#time vector</span></span>
<span id="cb41-6"><a href="#cb41-6"></a></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="co">#First signal</span></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="co">#1. 1 Hz with amplitude of 4</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>S1 &lt;-<span class="st"> </span><span class="dv">4</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t)</span>
<span id="cb41-10"><a href="#cb41-10"></a>S1.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S1))</span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="kw">colnames</span>(S1.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>)</span>
<span id="cb41-12"><a href="#cb41-12"></a></span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="co">#Second signal</span></span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="co">#1. 1 Hz with amplitude of -2</span></span>
<span id="cb41-15"><a href="#cb41-15"></a><span class="co">#2. 2 Hz with amplitude of -2</span></span>
<span id="cb41-16"><a href="#cb41-16"></a>S2 &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">2</span><span class="op">*</span>t);</span>
<span id="cb41-17"><a href="#cb41-17"></a>S2.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S2))</span>
<span id="cb41-18"><a href="#cb41-18"></a><span class="kw">colnames</span>(S2.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>)</span>
<span id="cb41-19"><a href="#cb41-19"></a></span>
<span id="cb41-20"><a href="#cb41-20"></a><span class="co">#Third signal</span></span>
<span id="cb41-21"><a href="#cb41-21"></a><span class="co">#1. 1 Hz with amplitude of 2</span></span>
<span id="cb41-22"><a href="#cb41-22"></a><span class="co">#2. 2 Hz with amplitude of 2</span></span>
<span id="cb41-23"><a href="#cb41-23"></a>S3 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">2</span><span class="op">*</span>t);</span>
<span id="cb41-24"><a href="#cb41-24"></a>S3.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S3))</span>
<span id="cb41-25"><a href="#cb41-25"></a><span class="kw">colnames</span>(S3.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>)</span>
<span id="cb41-26"><a href="#cb41-26"></a></span>
<span id="cb41-27"><a href="#cb41-27"></a><span class="co">#Add all signals to a List</span></span>
<span id="cb41-28"><a href="#cb41-28"></a>list.of.windows &lt;-<span class="st"> </span><span class="kw">list</span>(S1.data.frame, S2.data.frame, S3.data.frame)</span>
<span id="cb41-29"><a href="#cb41-29"></a></span>
<span id="cb41-30"><a href="#cb41-30"></a>results &lt;-<span class="st"> </span><span class="kw">MakeCompositeXYPlotForAllWindows</span>(list.of.windows, <span class="st">&quot;Signal&quot;</span>, <span class="dv">0</span>, <span class="dv">999</span>, <span class="dv">1</span>)</span>
<span id="cb41-31"><a href="#cb41-31"></a></span>
<span id="cb41-32"><a href="#cb41-32"></a>x.values &lt;-<span class="st"> </span>results[[<span class="dv">1</span>]]</span>
<span id="cb41-33"><a href="#cb41-33"></a></span>
<span id="cb41-34"><a href="#cb41-34"></a>y.values &lt;-<span class="st"> </span>results[[<span class="dv">2</span>]]</span>
<span id="cb41-35"><a href="#cb41-35"></a></span>
<span id="cb41-36"><a href="#cb41-36"></a>stddev.y.values &lt;-<span class="st"> </span>results[[<span class="dv">3</span>]]</span>
<span id="cb41-37"><a href="#cb41-37"></a></span>
<span id="cb41-38"><a href="#cb41-38"></a><span class="co">#plot each xy plot individually</span></span>
<span id="cb41-39"><a href="#cb41-39"></a><span class="kw">plot</span>(t, S1, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb41-40"><a href="#cb41-40"></a><span class="kw">lines</span>(t, S2, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb41-41"><a href="#cb41-41"></a><span class="kw">lines</span>(t, S3, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co">#plot the averaged plot</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="co">#The only curve remaining should be the 1Hz with amplitude of 4/3.</span></span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="kw">plot</span>(x.values, y.values, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="makeonesidedamplitudespectrum" class="section level3">
<h3>MakeOneSidedAmplitudeSpectrum()</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co">#Create a vector of time that represent times where data are sampled.</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>Fs =<span class="st"> </span><span class="dv">100</span>; <span class="co">#sampling frequency in Hz</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>T =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>Fs; <span class="co">#sampling period</span></span>
<span id="cb43-4"><a href="#cb43-4"></a>L =<span class="st"> </span><span class="dv">1000</span>; <span class="co">#length of time vector</span></span>
<span id="cb43-5"><a href="#cb43-5"></a>t =<span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(L<span class="dv">-1</span>))<span class="op">*</span>T; <span class="co">#time vector</span></span>
<span id="cb43-6"><a href="#cb43-6"></a></span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="co">#Form a signal (time series) that contains two frequencies:</span></span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="co">#1. 10 Hz with amplitude of 1</span></span>
<span id="cb43-9"><a href="#cb43-9"></a><span class="co">#2. 25 Hz with amplitude of 2</span></span>
<span id="cb43-10"><a href="#cb43-10"></a>S &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">10</span><span class="op">*</span>t) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">25</span><span class="op">*</span>t);</span>
<span id="cb43-11"><a href="#cb43-11"></a></span>
<span id="cb43-12"><a href="#cb43-12"></a>results &lt;-<span class="st"> </span><span class="kw">MakeOneSidedAmplitudeSpectrum</span>(Fs, S)</span>
<span id="cb43-13"><a href="#cb43-13"></a></span>
<span id="cb43-14"><a href="#cb43-14"></a>frequencies &lt;-<span class="st"> </span>results[[<span class="dv">1</span>]]</span>
<span id="cb43-15"><a href="#cb43-15"></a></span>
<span id="cb43-16"><a href="#cb43-16"></a>amplitudes &lt;-<span class="st"> </span>results[[<span class="dv">2</span>]]</span>
<span id="cb43-17"><a href="#cb43-17"></a></span>
<span id="cb43-18"><a href="#cb43-18"></a><span class="co">#dev.new()</span></span>
<span id="cb43-19"><a href="#cb43-19"></a><span class="kw">plot</span>(frequencies, amplitudes, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="makepowerspectraldensity" class="section level3">
<h3>MakePowerSpectralDensity()</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co">#Create a vector of time that represent times where data are sampled.</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>Fs =<span class="st"> </span><span class="dv">100</span>; <span class="co">#sampling frequency in Hz (sampling/second)</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>T =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>Fs; <span class="co">#sampling period</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>L =<span class="st"> </span><span class="dv">1000</span>; <span class="co">#length of time vector</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>t =<span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(L<span class="dv">-1</span>))<span class="op">*</span>T; <span class="co">#time vector in seconds</span></span>
<span id="cb44-6"><a href="#cb44-6"></a></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="co">#Form a signal (time series) that contains two frequencies:</span></span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="co">#1. 10 Hz with amplitude of 1</span></span>
<span id="cb44-9"><a href="#cb44-9"></a><span class="co">#2. 25 Hz with amplitude of 2</span></span>
<span id="cb44-10"><a href="#cb44-10"></a>S &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">10</span><span class="op">*</span>t) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">25</span><span class="op">*</span>t);</span>
<span id="cb44-11"><a href="#cb44-11"></a></span>
<span id="cb44-12"><a href="#cb44-12"></a><span class="co">#Plot the signal</span></span>
<span id="cb44-13"><a href="#cb44-13"></a><span class="kw">plot</span>(t[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>], S[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>], <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co">#Make a PSD to see the frequencies in the signal</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>results &lt;-<span class="st"> </span><span class="kw">MakePowerSpectralDensity</span>(Fs, S)</span>
<span id="cb45-3"><a href="#cb45-3"></a></span>
<span id="cb45-4"><a href="#cb45-4"></a>frequencies &lt;-<span class="st"> </span>results[[<span class="dv">1</span>]]</span>
<span id="cb45-5"><a href="#cb45-5"></a></span>
<span id="cb45-6"><a href="#cb45-6"></a>PSD &lt;-<span class="st"> </span>results[[<span class="dv">2</span>]]</span>
<span id="cb45-7"><a href="#cb45-7"></a></span>
<span id="cb45-8"><a href="#cb45-8"></a><span class="co">#dev.new()</span></span>
<span id="cb45-9"><a href="#cb45-9"></a><span class="kw">plot</span>(frequencies, PSD, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="psddominantfrequencyformultiplewindows" class="section level3">
<h3>PSDDominantFrequencyForMultipleWindows()</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co">#Create a vector of time that represent times where data are sampled.</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>Fs =<span class="st"> </span><span class="dv">100</span>; <span class="co">#sampling frequency in Hz</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>T =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>Fs; <span class="co">#sampling period</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>L =<span class="st"> </span><span class="dv">1000</span>; <span class="co">#length of time vector</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>t =<span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(L<span class="dv">-1</span>))<span class="op">*</span>T; <span class="co">#time vector</span></span>
<span id="cb46-6"><a href="#cb46-6"></a></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="co">#First signal</span></span>
<span id="cb46-8"><a href="#cb46-8"></a><span class="co">#1. 1 Hz with amplitude of 2</span></span>
<span id="cb46-9"><a href="#cb46-9"></a>S1 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t)</span>
<span id="cb46-10"><a href="#cb46-10"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S1))</span>
<span id="cb46-11"><a href="#cb46-11"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="kw">length</span>(S1))</span>
<span id="cb46-12"><a href="#cb46-12"></a>S1.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S1, level1.vals, level2.vals))</span>
<span id="cb46-13"><a href="#cb46-13"></a><span class="kw">colnames</span>(S1.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb46-14"><a href="#cb46-14"></a>S1.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S1.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb46-15"><a href="#cb46-15"></a></span>
<span id="cb46-16"><a href="#cb46-16"></a><span class="co">#Second signal</span></span>
<span id="cb46-17"><a href="#cb46-17"></a><span class="co">#1. 1 Hz with amplitude of -4</span></span>
<span id="cb46-18"><a href="#cb46-18"></a><span class="co">#2. 2 Hz with amplitude of -2</span></span>
<span id="cb46-19"><a href="#cb46-19"></a>S2 &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">4</span>)<span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">2</span><span class="op">*</span>t);</span>
<span id="cb46-20"><a href="#cb46-20"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S2))</span>
<span id="cb46-21"><a href="#cb46-21"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="kw">length</span>(S2))</span>
<span id="cb46-22"><a href="#cb46-22"></a>S2.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S2, level1.vals, level2.vals))</span>
<span id="cb46-23"><a href="#cb46-23"></a><span class="kw">colnames</span>(S2.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb46-24"><a href="#cb46-24"></a>S2.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S2.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb46-25"><a href="#cb46-25"></a></span>
<span id="cb46-26"><a href="#cb46-26"></a><span class="co">#Third signal</span></span>
<span id="cb46-27"><a href="#cb46-27"></a><span class="co">#1. 1 Hz with amplitude of 2</span></span>
<span id="cb46-28"><a href="#cb46-28"></a><span class="co">#2. 2 Hz with amplitude of 2</span></span>
<span id="cb46-29"><a href="#cb46-29"></a>S3 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">2</span><span class="op">*</span>t);</span>
<span id="cb46-30"><a href="#cb46-30"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S3))</span>
<span id="cb46-31"><a href="#cb46-31"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;3&quot;</span>, <span class="kw">length</span>(S3))</span>
<span id="cb46-32"><a href="#cb46-32"></a>S3.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S3, level1.vals, level2.vals))</span>
<span id="cb46-33"><a href="#cb46-33"></a><span class="kw">colnames</span>(S3.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb46-34"><a href="#cb46-34"></a>S3.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S3.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb46-35"><a href="#cb46-35"></a></span>
<span id="cb46-36"><a href="#cb46-36"></a><span class="co">#Fourth signal</span></span>
<span id="cb46-37"><a href="#cb46-37"></a><span class="co">#1. 1 Hz with amplitude of -2</span></span>
<span id="cb46-38"><a href="#cb46-38"></a>S4 &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t)</span>
<span id="cb46-39"><a href="#cb46-39"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;b&quot;</span>, <span class="kw">length</span>(S4))</span>
<span id="cb46-40"><a href="#cb46-40"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;3&quot;</span>, <span class="kw">length</span>(S4))</span>
<span id="cb46-41"><a href="#cb46-41"></a>S4.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S4, level1.vals, level2.vals))</span>
<span id="cb46-42"><a href="#cb46-42"></a><span class="kw">colnames</span>(S4.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb46-43"><a href="#cb46-43"></a>S4.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S4.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb46-44"><a href="#cb46-44"></a></span>
<span id="cb46-45"><a href="#cb46-45"></a>windows &lt;-<span class="st"> </span><span class="kw">list</span>(S1.data.frame, S2.data.frame, S3.data.frame, S4.data.frame)</span>
<span id="cb46-46"><a href="#cb46-46"></a></span>
<span id="cb46-47"><a href="#cb46-47"></a><span class="co">#Plot the PSD for each window</span></span>
<span id="cb46-48"><a href="#cb46-48"></a>FirstComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>), <span class="kw">c</span>(<span class="dv">1</span>) )</span>
<span id="cb46-49"><a href="#cb46-49"></a>SecondComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>), <span class="kw">c</span>(<span class="dv">2</span>) )</span>
<span id="cb46-50"><a href="#cb46-50"></a>ThirdComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>), <span class="kw">c</span>(<span class="dv">3</span>) )</span>
<span id="cb46-51"><a href="#cb46-51"></a>FourthComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;b&quot;</span>), <span class="kw">c</span>(<span class="dv">3</span>) )</span>
<span id="cb46-52"><a href="#cb46-52"></a>PSD.results &lt;-<span class="st"> </span><span class="kw">AutomatedCompositePlotting</span>(<span class="dt">list.of.windows =</span> windows,</span>
<span id="cb46-53"><a href="#cb46-53"></a>                           <span class="dt">name.of.col.containing.time.series =</span> <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb46-54"><a href="#cb46-54"></a>                           <span class="dt">x_start =</span> <span class="dv">0</span>,</span>
<span id="cb46-55"><a href="#cb46-55"></a>                           <span class="dt">x_end =</span> <span class="dv">5</span>,</span>
<span id="cb46-56"><a href="#cb46-56"></a>                           <span class="dt">x_increment =</span> <span class="fl">0.01</span>,</span>
<span id="cb46-57"><a href="#cb46-57"></a>                           <span class="dt">level1.column.name =</span> <span class="st">&quot;level1.ID&quot;</span>,</span>
<span id="cb46-58"><a href="#cb46-58"></a>                           <span class="dt">level2.column.name =</span> <span class="st">&quot;level2.ID&quot;</span>,</span>
<span id="cb46-59"><a href="#cb46-59"></a>                           <span class="dt">level.combinations =</span> <span class="kw">list</span>(FirstComboToUse, SecondComboToUse, </span>
<span id="cb46-60"><a href="#cb46-60"></a>                                                     ThirdComboToUse, FourthComboToUse),</span>
<span id="cb46-61"><a href="#cb46-61"></a>                           <span class="dt">level.combinations.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Signal 1&quot;</span>, <span class="st">&quot;Signal 2&quot;</span>, </span>
<span id="cb46-62"><a href="#cb46-62"></a>                                                         <span class="st">&quot;Signal 3&quot;</span>, <span class="st">&quot;Signal 4&quot;</span>),</span>
<span id="cb46-63"><a href="#cb46-63"></a>                           <span class="dt">plot.title =</span> <span class="st">&quot;Example&quot;</span>,</span>
<span id="cb46-64"><a href="#cb46-64"></a>                           <span class="dt">plot.xlab =</span> <span class="st">&quot;Hz&quot;</span>,</span>
<span id="cb46-65"><a href="#cb46-65"></a>                           <span class="dt">plot.ylab =</span> <span class="st">&quot;(Original units)^2/Hz&quot;</span>,</span>
<span id="cb46-66"><a href="#cb46-66"></a>                           <span class="dt">combination.index.for.envelope =</span> <span class="dv">2</span>,</span>
<span id="cb46-67"><a href="#cb46-67"></a>                           <span class="dt">TimeSeries.PSD.LogPSD =</span> <span class="st">&quot;PSD&quot;</span>,</span>
<span id="cb46-68"><a href="#cb46-68"></a>                           <span class="dt">sampling_frequency =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>ggplot.obj.PSD &lt;-<span class="st"> </span>PSD.results[[<span class="dv">2</span>]]</span>
<span id="cb48-2"><a href="#cb48-2"></a></span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="co">#Plot</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>ggplot.obj.PSD</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co">#Calculate the dominant frequency for each window</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>results &lt;-<span class="st"> </span><span class="kw">PSDDominantFrequencyForMultipleWindows</span>(windows, <span class="st">&quot;Signal&quot;</span>, Fs, <span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb49-3"><a href="#cb49-3"></a></span>
<span id="cb49-4"><a href="#cb49-4"></a>results</span></code></pre></div>
<pre><code>## [1] 1 1 2 1</code></pre>
</div>
<div id="psdidentifydominantfrequency" class="section level3">
<h3>PSDIdentifyDominantFrequency()</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co">#Create a vector of time that represent times where data are sampled.</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>Fs =<span class="st"> </span><span class="dv">100</span>; <span class="co">#sampling frequency in Hz</span></span>
<span id="cb51-3"><a href="#cb51-3"></a>T =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>Fs; <span class="co">#sampling period</span></span>
<span id="cb51-4"><a href="#cb51-4"></a>L =<span class="st"> </span><span class="dv">1000</span>; <span class="co">#length of time vector</span></span>
<span id="cb51-5"><a href="#cb51-5"></a>t =<span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(L<span class="dv">-1</span>))<span class="op">*</span>T; <span class="co">#time vector</span></span>
<span id="cb51-6"><a href="#cb51-6"></a></span>
<span id="cb51-7"><a href="#cb51-7"></a><span class="co">#First signal</span></span>
<span id="cb51-8"><a href="#cb51-8"></a><span class="co">#1. 1 Hz with amplitude of 2</span></span>
<span id="cb51-9"><a href="#cb51-9"></a>S1 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t)</span>
<span id="cb51-10"><a href="#cb51-10"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S1))</span>
<span id="cb51-11"><a href="#cb51-11"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="kw">length</span>(S1))</span>
<span id="cb51-12"><a href="#cb51-12"></a>S1.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S1, level1.vals, level2.vals))</span>
<span id="cb51-13"><a href="#cb51-13"></a><span class="kw">colnames</span>(S1.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb51-14"><a href="#cb51-14"></a>S1.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S1.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb51-15"><a href="#cb51-15"></a></span>
<span id="cb51-16"><a href="#cb51-16"></a>results &lt;-<span class="st"> </span><span class="kw">PSDIdentifyDominantFrequency</span>(Fs, S1.data.frame[,<span class="st">&quot;Signal&quot;</span>], <span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb51-17"><a href="#cb51-17"></a></span>
<span id="cb51-18"><a href="#cb51-18"></a>results</span></code></pre></div>
<pre><code>##     xval yval
## 101    1 0.02</code></pre>
</div>
<div id="psdintegrationperfreqbin" class="section level3">
<h3>PSDIntegrationPerFreqBin()</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co">#Create a vector of time that represent times where data are sampled.</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>Fs =<span class="st"> </span><span class="dv">100</span>; <span class="co">#sampling frequency in Hz</span></span>
<span id="cb53-3"><a href="#cb53-3"></a>T =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>Fs; <span class="co">#sampling period</span></span>
<span id="cb53-4"><a href="#cb53-4"></a>L =<span class="st"> </span><span class="dv">1000</span>; <span class="co">#length of time vector</span></span>
<span id="cb53-5"><a href="#cb53-5"></a>t =<span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(L<span class="dv">-1</span>))<span class="op">*</span>T; <span class="co">#time vector</span></span>
<span id="cb53-6"><a href="#cb53-6"></a></span>
<span id="cb53-7"><a href="#cb53-7"></a><span class="co">#Form a signal (time series) that contains two frequencies:</span></span>
<span id="cb53-8"><a href="#cb53-8"></a><span class="co">#1. 10 Hz with amplitude of 1</span></span>
<span id="cb53-9"><a href="#cb53-9"></a><span class="co">#2. 25 Hz with amplitude of 2</span></span>
<span id="cb53-10"><a href="#cb53-10"></a>S &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">10</span><span class="op">*</span>t) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">25</span><span class="op">*</span>t);</span>
<span id="cb53-11"><a href="#cb53-11"></a></span>
<span id="cb53-12"><a href="#cb53-12"></a>results &lt;-<span class="st"> </span><span class="kw">MakePowerSpectralDensity</span>(Fs, S)</span>
<span id="cb53-13"><a href="#cb53-13"></a></span>
<span id="cb53-14"><a href="#cb53-14"></a>frequencies &lt;-<span class="st"> </span>results[[<span class="dv">1</span>]]</span>
<span id="cb53-15"><a href="#cb53-15"></a></span>
<span id="cb53-16"><a href="#cb53-16"></a>PSD &lt;-<span class="st"> </span>results[[<span class="dv">2</span>]]</span>
<span id="cb53-17"><a href="#cb53-17"></a></span>
<span id="cb53-18"><a href="#cb53-18"></a><span class="kw">plot</span>(frequencies, PSD, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>bins &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">11</span>),</span>
<span id="cb54-3"><a href="#cb54-3"></a><span class="kw">c</span>(<span class="dv">24</span>,<span class="dv">26</span>),</span>
<span id="cb54-4"><a href="#cb54-4"></a><span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">26</span>),</span>
<span id="cb54-5"><a href="#cb54-5"></a><span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">40</span>)</span>
<span id="cb54-6"><a href="#cb54-6"></a>)</span>
<span id="cb54-7"><a href="#cb54-7"></a></span>
<span id="cb54-8"><a href="#cb54-8"></a>integration.results &lt;-<span class="st"> </span><span class="kw">PSDIntegrationPerFreqBin</span>(Fs, S, bins)</span>
<span id="cb54-9"><a href="#cb54-9"></a></span>
<span id="cb54-10"><a href="#cb54-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(integration.results)){</span>
<span id="cb54-11"><a href="#cb54-11"></a></span>
<span id="cb54-12"><a href="#cb54-12"></a>   message &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Area in bin &quot;</span>, integration.results[[i]][[<span class="dv">1</span>]], <span class="st">&quot; is &quot;</span>,</span>
<span id="cb54-13"><a href="#cb54-13"></a>                   integration.results[[i]][[<span class="dv">2</span>]])</span>
<span id="cb54-14"><a href="#cb54-14"></a></span>
<span id="cb54-15"><a href="#cb54-15"></a>   <span class="kw">print</span>(message)</span>
<span id="cb54-16"><a href="#cb54-16"></a></span>
<span id="cb54-17"><a href="#cb54-17"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Area in bin  9 - 11  is  0.00050011493570859&quot;
## [1] &quot;Area in bin  24 - 26  is  0.00200024756472286&quot;
## [1] &quot;Area in bin  9 - 26  is  0.00249982073718224&quot;
## [1] &quot;Area in bin  30 - 40  is  1.40556982936425e-30&quot;</code></pre>
</div>
<div id="singlebinpsdintegrationformultiplewindows" class="section level3">
<h3>SingleBinPSDIntegrationForMultipleWindows()</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co">#Create a vector of time that represent times where data are sampled.</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>Fs =<span class="st"> </span><span class="dv">100</span>; <span class="co">#sampling frequency in Hz</span></span>
<span id="cb56-3"><a href="#cb56-3"></a>T =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>Fs; <span class="co">#sampling period</span></span>
<span id="cb56-4"><a href="#cb56-4"></a>L =<span class="st"> </span><span class="dv">1000</span>; <span class="co">#length of time vector</span></span>
<span id="cb56-5"><a href="#cb56-5"></a>t =<span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(L<span class="dv">-1</span>))<span class="op">*</span>T; <span class="co">#time vector</span></span>
<span id="cb56-6"><a href="#cb56-6"></a></span>
<span id="cb56-7"><a href="#cb56-7"></a><span class="co">#First signal</span></span>
<span id="cb56-8"><a href="#cb56-8"></a><span class="co">#1. 1 Hz with amplitude of 2</span></span>
<span id="cb56-9"><a href="#cb56-9"></a>S1 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t)</span>
<span id="cb56-10"><a href="#cb56-10"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S1))</span>
<span id="cb56-11"><a href="#cb56-11"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="kw">length</span>(S1))</span>
<span id="cb56-12"><a href="#cb56-12"></a>S1.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S1, level1.vals, level2.vals))</span>
<span id="cb56-13"><a href="#cb56-13"></a><span class="kw">colnames</span>(S1.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb56-14"><a href="#cb56-14"></a>S1.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S1.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb56-15"><a href="#cb56-15"></a></span>
<span id="cb56-16"><a href="#cb56-16"></a><span class="co">#Second signal</span></span>
<span id="cb56-17"><a href="#cb56-17"></a><span class="co">#1. 1 Hz with amplitude of -4</span></span>
<span id="cb56-18"><a href="#cb56-18"></a><span class="co">#2. 2 Hz with amplitude of -2</span></span>
<span id="cb56-19"><a href="#cb56-19"></a>S2 &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">4</span>)<span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">2</span><span class="op">*</span>t);</span>
<span id="cb56-20"><a href="#cb56-20"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S2))</span>
<span id="cb56-21"><a href="#cb56-21"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="kw">length</span>(S2))</span>
<span id="cb56-22"><a href="#cb56-22"></a>S2.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S2, level1.vals, level2.vals))</span>
<span id="cb56-23"><a href="#cb56-23"></a><span class="kw">colnames</span>(S2.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb56-24"><a href="#cb56-24"></a>S2.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S2.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb56-25"><a href="#cb56-25"></a></span>
<span id="cb56-26"><a href="#cb56-26"></a><span class="co">#Third signal</span></span>
<span id="cb56-27"><a href="#cb56-27"></a><span class="co">#1. 1 Hz with amplitude of 2</span></span>
<span id="cb56-28"><a href="#cb56-28"></a><span class="co">#2. 2 Hz with amplitude of 2</span></span>
<span id="cb56-29"><a href="#cb56-29"></a>S3 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">2</span><span class="op">*</span>t);</span>
<span id="cb56-30"><a href="#cb56-30"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S3))</span>
<span id="cb56-31"><a href="#cb56-31"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;3&quot;</span>, <span class="kw">length</span>(S3))</span>
<span id="cb56-32"><a href="#cb56-32"></a>S3.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S3, level1.vals, level2.vals))</span>
<span id="cb56-33"><a href="#cb56-33"></a><span class="kw">colnames</span>(S3.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb56-34"><a href="#cb56-34"></a>S3.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S3.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb56-35"><a href="#cb56-35"></a></span>
<span id="cb56-36"><a href="#cb56-36"></a><span class="co">#Fourth signal</span></span>
<span id="cb56-37"><a href="#cb56-37"></a><span class="co">#1. 1 Hz with amplitude of -2</span></span>
<span id="cb56-38"><a href="#cb56-38"></a>S4 &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t)</span>
<span id="cb56-39"><a href="#cb56-39"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;b&quot;</span>, <span class="kw">length</span>(S4))</span>
<span id="cb56-40"><a href="#cb56-40"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;3&quot;</span>, <span class="kw">length</span>(S4))</span>
<span id="cb56-41"><a href="#cb56-41"></a>S4.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S4, level1.vals, level2.vals))</span>
<span id="cb56-42"><a href="#cb56-42"></a><span class="kw">colnames</span>(S4.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb56-43"><a href="#cb56-43"></a>S4.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S4.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb56-44"><a href="#cb56-44"></a></span>
<span id="cb56-45"><a href="#cb56-45"></a>windows &lt;-<span class="st"> </span><span class="kw">list</span>(S1.data.frame, S2.data.frame, S3.data.frame, S4.data.frame)</span>
<span id="cb56-46"><a href="#cb56-46"></a></span>
<span id="cb56-47"><a href="#cb56-47"></a><span class="co">#Plot the PSD for each window</span></span>
<span id="cb56-48"><a href="#cb56-48"></a>FirstComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>), <span class="kw">c</span>(<span class="dv">1</span>) )</span>
<span id="cb56-49"><a href="#cb56-49"></a>SecondComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>), <span class="kw">c</span>(<span class="dv">2</span>) )</span>
<span id="cb56-50"><a href="#cb56-50"></a>ThirdComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>), <span class="kw">c</span>(<span class="dv">3</span>) )</span>
<span id="cb56-51"><a href="#cb56-51"></a>FourthComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;b&quot;</span>), <span class="kw">c</span>(<span class="dv">3</span>) )</span>
<span id="cb56-52"><a href="#cb56-52"></a>PSD.results &lt;-<span class="st"> </span><span class="kw">AutomatedCompositePlotting</span>(<span class="dt">list.of.windows =</span> windows,</span>
<span id="cb56-53"><a href="#cb56-53"></a>                           <span class="dt">name.of.col.containing.time.series =</span> <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb56-54"><a href="#cb56-54"></a>                           <span class="dt">x_start =</span> <span class="dv">0</span>,</span>
<span id="cb56-55"><a href="#cb56-55"></a>                           <span class="dt">x_end =</span> <span class="dv">5</span>,</span>
<span id="cb56-56"><a href="#cb56-56"></a>                           <span class="dt">x_increment =</span> <span class="fl">0.01</span>,</span>
<span id="cb56-57"><a href="#cb56-57"></a>                           <span class="dt">level1.column.name =</span> <span class="st">&quot;level1.ID&quot;</span>,</span>
<span id="cb56-58"><a href="#cb56-58"></a>                           <span class="dt">level2.column.name =</span> <span class="st">&quot;level2.ID&quot;</span>,</span>
<span id="cb56-59"><a href="#cb56-59"></a>                           <span class="dt">level.combinations =</span> <span class="kw">list</span>(FirstComboToUse, SecondComboToUse, </span>
<span id="cb56-60"><a href="#cb56-60"></a>                                                     ThirdComboToUse, FourthComboToUse),</span>
<span id="cb56-61"><a href="#cb56-61"></a>                           <span class="dt">level.combinations.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Signal 1&quot;</span>, <span class="st">&quot;Signal 2&quot;</span>, </span>
<span id="cb56-62"><a href="#cb56-62"></a>                                                         <span class="st">&quot;Signal 3&quot;</span>, <span class="st">&quot;Signal 4&quot;</span>),</span>
<span id="cb56-63"><a href="#cb56-63"></a>                           <span class="dt">plot.title =</span> <span class="st">&quot;Example&quot;</span>,</span>
<span id="cb56-64"><a href="#cb56-64"></a>                           <span class="dt">plot.xlab =</span> <span class="st">&quot;Hz&quot;</span>,</span>
<span id="cb56-65"><a href="#cb56-65"></a>                           <span class="dt">plot.ylab =</span> <span class="st">&quot;(Original units)^2/Hz&quot;</span>,</span>
<span id="cb56-66"><a href="#cb56-66"></a>                           <span class="dt">combination.index.for.envelope =</span> <span class="dv">2</span>,</span>
<span id="cb56-67"><a href="#cb56-67"></a>                           <span class="dt">TimeSeries.PSD.LogPSD =</span> <span class="st">&quot;PSD&quot;</span>,</span>
<span id="cb56-68"><a href="#cb56-68"></a>                           <span class="dt">sampling_frequency =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>ggplot.obj.PSD &lt;-<span class="st"> </span>PSD.results[[<span class="dv">2</span>]]</span>
<span id="cb58-2"><a href="#cb58-2"></a></span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="co">#Plot</span></span>
<span id="cb58-4"><a href="#cb58-4"></a>ggplot.obj.PSD</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co">#For each of the 4 windows, calculate the area under the PSD from 0-2 Hz</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>results &lt;-<span class="st"> </span><span class="kw">SingleBinPSDIntegrationForMultipleWindows</span>(windows, <span class="st">&quot;Signal&quot;</span>, Fs, <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb59-3"><a href="#cb59-3"></a></span>
<span id="cb59-4"><a href="#cb59-4"></a>results</span></code></pre></div>
<pre><code>## [1] 0.002000248 0.009000239 0.003000262 0.002000248</code></pre>
</div>
<div id="singlebinpsdintegrationordominantfreqcomparison" class="section level3">
<h3>SingleBinPSDIntegrationOrDominantFreqComparison()</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co">#Create a vector of time that represent times where data are sampled.</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>Fs =<span class="st"> </span><span class="dv">100</span>; <span class="co">#sampling frequency in Hz</span></span>
<span id="cb61-3"><a href="#cb61-3"></a>T =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>Fs; <span class="co">#sampling period</span></span>
<span id="cb61-4"><a href="#cb61-4"></a>L =<span class="st"> </span><span class="dv">1000</span>; <span class="co">#length of time vector</span></span>
<span id="cb61-5"><a href="#cb61-5"></a>t =<span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(L<span class="dv">-1</span>))<span class="op">*</span>T; <span class="co">#time vector</span></span>
<span id="cb61-6"><a href="#cb61-6"></a></span>
<span id="cb61-7"><a href="#cb61-7"></a><span class="co">#First signal</span></span>
<span id="cb61-8"><a href="#cb61-8"></a><span class="co">#1. 1 Hz with amplitude of 2</span></span>
<span id="cb61-9"><a href="#cb61-9"></a>S1 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t)</span>
<span id="cb61-10"><a href="#cb61-10"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S1))</span>
<span id="cb61-11"><a href="#cb61-11"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="kw">length</span>(S1))</span>
<span id="cb61-12"><a href="#cb61-12"></a>S1.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S1, level1.vals, level2.vals))</span>
<span id="cb61-13"><a href="#cb61-13"></a><span class="kw">colnames</span>(S1.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb61-14"><a href="#cb61-14"></a>S1.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S1.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb61-15"><a href="#cb61-15"></a></span>
<span id="cb61-16"><a href="#cb61-16"></a><span class="co">#Second signal</span></span>
<span id="cb61-17"><a href="#cb61-17"></a><span class="co">#1. 1 Hz with amplitude of -4</span></span>
<span id="cb61-18"><a href="#cb61-18"></a><span class="co">#2. 2 Hz with amplitude of -2</span></span>
<span id="cb61-19"><a href="#cb61-19"></a>S2 &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">4</span>)<span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">2</span><span class="op">*</span>t);</span>
<span id="cb61-20"><a href="#cb61-20"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S2))</span>
<span id="cb61-21"><a href="#cb61-21"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="kw">length</span>(S2))</span>
<span id="cb61-22"><a href="#cb61-22"></a>S2.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S2, level1.vals, level2.vals))</span>
<span id="cb61-23"><a href="#cb61-23"></a><span class="kw">colnames</span>(S2.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb61-24"><a href="#cb61-24"></a>S2.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S2.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb61-25"><a href="#cb61-25"></a></span>
<span id="cb61-26"><a href="#cb61-26"></a><span class="co">#Third signal</span></span>
<span id="cb61-27"><a href="#cb61-27"></a><span class="co">#1. 1 Hz with amplitude of 2</span></span>
<span id="cb61-28"><a href="#cb61-28"></a><span class="co">#2. 2 Hz with amplitude of 2</span></span>
<span id="cb61-29"><a href="#cb61-29"></a>S3 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">2</span><span class="op">*</span>t);</span>
<span id="cb61-30"><a href="#cb61-30"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">length</span>(S3))</span>
<span id="cb61-31"><a href="#cb61-31"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;3&quot;</span>, <span class="kw">length</span>(S3))</span>
<span id="cb61-32"><a href="#cb61-32"></a>S3.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S3, level1.vals, level2.vals))</span>
<span id="cb61-33"><a href="#cb61-33"></a><span class="kw">colnames</span>(S3.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb61-34"><a href="#cb61-34"></a>S3.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S3.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb61-35"><a href="#cb61-35"></a></span>
<span id="cb61-36"><a href="#cb61-36"></a><span class="co">#Fourth signal</span></span>
<span id="cb61-37"><a href="#cb61-37"></a><span class="co">#1. 1 Hz with amplitude of -2</span></span>
<span id="cb61-38"><a href="#cb61-38"></a>S4 &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">1</span><span class="op">*</span>t)</span>
<span id="cb61-39"><a href="#cb61-39"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;b&quot;</span>, <span class="kw">length</span>(S4))</span>
<span id="cb61-40"><a href="#cb61-40"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;3&quot;</span>, <span class="kw">length</span>(S4))</span>
<span id="cb61-41"><a href="#cb61-41"></a>S4.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S4, level1.vals, level2.vals))</span>
<span id="cb61-42"><a href="#cb61-42"></a><span class="kw">colnames</span>(S4.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb61-43"><a href="#cb61-43"></a>S4.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S4.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb61-44"><a href="#cb61-44"></a></span>
<span id="cb61-45"><a href="#cb61-45"></a><span class="co">#Fifth signal</span></span>
<span id="cb61-46"><a href="#cb61-46"></a><span class="co">#1. 5 Hz with amplitude of -2</span></span>
<span id="cb61-47"><a href="#cb61-47"></a>S5 &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">5</span><span class="op">*</span>t)</span>
<span id="cb61-48"><a href="#cb61-48"></a>level1.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="kw">length</span>(S5))</span>
<span id="cb61-49"><a href="#cb61-49"></a>level2.vals &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="kw">length</span>(S5))</span>
<span id="cb61-50"><a href="#cb61-50"></a>S5.data.frame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(t, S5, level1.vals, level2.vals))</span>
<span id="cb61-51"><a href="#cb61-51"></a><span class="kw">colnames</span>(S5.data.frame) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Signal&quot;</span>, <span class="st">&quot;level1.ID&quot;</span>, <span class="st">&quot;level2.ID&quot;</span>)</span>
<span id="cb61-52"><a href="#cb61-52"></a>S5.data.frame[,<span class="st">&quot;Signal&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(S5.data.frame[,<span class="st">&quot;Signal&quot;</span>])</span>
<span id="cb61-53"><a href="#cb61-53"></a></span>
<span id="cb61-54"><a href="#cb61-54"></a><span class="co">#Extra representation of S2 dataframe to show an example that has enough samples</span></span>
<span id="cb61-55"><a href="#cb61-55"></a><span class="co">#to have significance for Kruskal-Wallis test</span></span>
<span id="cb61-56"><a href="#cb61-56"></a>windows &lt;-<span class="st"> </span><span class="kw">list</span>(S1.data.frame, S2.data.frame, S2.data.frame, S2.data.frame, S2.data.frame,</span>
<span id="cb61-57"><a href="#cb61-57"></a>S2.data.frame, S2.data.frame, S2.data.frame, S2.data.frame, S2.data.frame, S3.data.frame,</span>
<span id="cb61-58"><a href="#cb61-58"></a>S4.data.frame,</span>
<span id="cb61-59"><a href="#cb61-59"></a>S5.data.frame, S5.data.frame, S5.data.frame, S5.data.frame, S5.data.frame)</span>
<span id="cb61-60"><a href="#cb61-60"></a></span>
<span id="cb61-61"><a href="#cb61-61"></a><span class="co">#Gets the composite of the first, second, and third signal. Should result in a flat signal.</span></span>
<span id="cb61-62"><a href="#cb61-62"></a>FirstComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) )</span>
<span id="cb61-63"><a href="#cb61-63"></a></span>
<span id="cb61-64"><a href="#cb61-64"></a><span class="co">#Gets the composite of the third and fourth signal</span></span>
<span id="cb61-65"><a href="#cb61-65"></a>SecondComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="kw">c</span>(<span class="dv">3</span>) )</span>
<span id="cb61-66"><a href="#cb61-66"></a></span>
<span id="cb61-67"><a href="#cb61-67"></a><span class="co">#Gets the composite of fifth signal</span></span>
<span id="cb61-68"><a href="#cb61-68"></a>ThirdComboToUse &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="kw">c</span>(<span class="st">&quot;c&quot;</span>), <span class="kw">c</span>(<span class="dv">1</span>) )</span>
<span id="cb61-69"><a href="#cb61-69"></a></span>
<span id="cb61-70"><a href="#cb61-70"></a></span>
<span id="cb61-71"><a href="#cb61-71"></a><span class="co">#PSD-------------------------------------------------------------------------</span></span>
<span id="cb61-72"><a href="#cb61-72"></a></span>
<span id="cb61-73"><a href="#cb61-73"></a>PSD.results &lt;-<span class="st"> </span><span class="kw">AutomatedCompositePlotting</span>(<span class="dt">list.of.windows =</span> windows,</span>
<span id="cb61-74"><a href="#cb61-74"></a>                           <span class="dt">name.of.col.containing.time.series =</span> <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb61-75"><a href="#cb61-75"></a>                           <span class="dt">x_start =</span> <span class="dv">0</span>,</span>
<span id="cb61-76"><a href="#cb61-76"></a>                           <span class="dt">x_end =</span> <span class="dv">10</span>,</span>
<span id="cb61-77"><a href="#cb61-77"></a>                           <span class="dt">x_increment =</span> <span class="fl">0.01</span>,</span>
<span id="cb61-78"><a href="#cb61-78"></a>                           <span class="dt">level1.column.name =</span> <span class="st">&quot;level1.ID&quot;</span>,</span>
<span id="cb61-79"><a href="#cb61-79"></a>                           <span class="dt">level2.column.name =</span> <span class="st">&quot;level2.ID&quot;</span>,</span>
<span id="cb61-80"><a href="#cb61-80"></a>                           <span class="dt">level.combinations =</span> <span class="kw">list</span>(FirstComboToUse,</span>
<span id="cb61-81"><a href="#cb61-81"></a>                                                    SecondComboToUse,</span>
<span id="cb61-82"><a href="#cb61-82"></a>                                                    ThirdComboToUse),</span>
<span id="cb61-83"><a href="#cb61-83"></a>                           <span class="dt">level.combinations.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Signal 1 + 2 + 3&quot;</span>,</span>
<span id="cb61-84"><a href="#cb61-84"></a>                                                         <span class="st">&quot;Signal 3 + 4&quot;</span>,</span>
<span id="cb61-85"><a href="#cb61-85"></a>                                                         <span class="st">&quot;Signal 5&quot;</span>),</span>
<span id="cb61-86"><a href="#cb61-86"></a>                           <span class="dt">plot.title =</span> <span class="st">&quot;Example&quot;</span>,</span>
<span id="cb61-87"><a href="#cb61-87"></a>                           <span class="dt">plot.xlab =</span> <span class="st">&quot;Hz&quot;</span>,</span>
<span id="cb61-88"><a href="#cb61-88"></a>                           <span class="dt">plot.ylab =</span> <span class="st">&quot;(Original units)^2/Hz&quot;</span>,</span>
<span id="cb61-89"><a href="#cb61-89"></a>                           <span class="dt">combination.index.for.envelope =</span> <span class="dv">2</span>,</span>
<span id="cb61-90"><a href="#cb61-90"></a>                           <span class="dt">TimeSeries.PSD.LogPSD =</span> <span class="st">&quot;PSD&quot;</span>,</span>
<span id="cb61-91"><a href="#cb61-91"></a>                           <span class="dt">sampling_frequency =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties

## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>ggplot.obj.PSD &lt;-<span class="st"> </span>PSD.results[[<span class="dv">2</span>]]</span>
<span id="cb63-2"><a href="#cb63-2"></a></span>
<span id="cb63-3"><a href="#cb63-3"></a>ggplot.obj.PSD</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co">#Integration-------------------------------------------------------------------------</span></span>
<span id="cb64-2"><a href="#cb64-2"></a></span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="co">#Compare integration for the 1.5-2.5 Hz bin. P-value should not indicate</span></span>
<span id="cb64-4"><a href="#cb64-4"></a><span class="co">#significant difference</span></span>
<span id="cb64-5"><a href="#cb64-5"></a>integration.compare.res &lt;-<span class="st"> </span><span class="kw">SingleBinPSDIntegrationOrDominantFreqComparison</span>(</span>
<span id="cb64-6"><a href="#cb64-6"></a><span class="dt">list.of.windows =</span> windows,</span>
<span id="cb64-7"><a href="#cb64-7"></a><span class="dt">name.of.col.containing.time.series =</span> <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb64-8"><a href="#cb64-8"></a><span class="dt">level1.column.name =</span> <span class="st">&quot;level1.ID&quot;</span>,</span>
<span id="cb64-9"><a href="#cb64-9"></a><span class="dt">level2.column.name =</span> <span class="st">&quot;level2.ID&quot;</span>,</span>
<span id="cb64-10"><a href="#cb64-10"></a><span class="dt">level.combinations =</span> <span class="kw">list</span>(FirstComboToUse, SecondComboToUse),</span>
<span id="cb64-11"><a href="#cb64-11"></a><span class="dt">level.combinations.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Signal 1 + 2 + 3&quot;</span>, <span class="st">&quot;Signal 3 + 4&quot;</span>),</span>
<span id="cb64-12"><a href="#cb64-12"></a><span class="dt">sampling_frequency =</span> <span class="dv">100</span>,</span>
<span id="cb64-13"><a href="#cb64-13"></a><span class="dt">single.bin.boundary =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>),</span>
<span id="cb64-14"><a href="#cb64-14"></a><span class="dt">integration.or.dominant.freq =</span> <span class="st">&quot;integration&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co">#Kruskal-Wallis test results</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>integration.compare.res[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  vals.to.compare.combined by combo.labels.combined
## Kruskal-Wallis chi-squared = 0, df = 1, p-value = 1</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co">#Values used in Kruskal-Wallis test</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>integration.compare.res[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>##    vals.to.compare.combined combo.labels.combined
## 1              4.733168e-35      Signal 1 + 2 + 3
## 2              2.000248e-03      Signal 1 + 2 + 3
## 3              2.000248e-03      Signal 1 + 2 + 3
## 4              2.000248e-03      Signal 1 + 2 + 3
## 5              2.000248e-03      Signal 1 + 2 + 3
## 6              2.000248e-03      Signal 1 + 2 + 3
## 7              2.000248e-03      Signal 1 + 2 + 3
## 8              2.000248e-03      Signal 1 + 2 + 3
## 9              2.000248e-03      Signal 1 + 2 + 3
## 10             2.000248e-03      Signal 1 + 2 + 3
## 11             2.000248e-03      Signal 1 + 2 + 3
## 12             2.000248e-03          Signal 3 + 4
## 13             4.733168e-35          Signal 3 + 4</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="co">#Compare integration for the 0.5-1.5 Hz bin. P-value should indicate</span></span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="co">#significant difference</span></span>
<span id="cb70-3"><a href="#cb70-3"></a>integration.compare.res2 &lt;-<span class="st"> </span><span class="kw">SingleBinPSDIntegrationOrDominantFreqComparison</span>(</span>
<span id="cb70-4"><a href="#cb70-4"></a><span class="dt">list.of.windows =</span> windows,</span>
<span id="cb70-5"><a href="#cb70-5"></a><span class="dt">name.of.col.containing.time.series =</span> <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb70-6"><a href="#cb70-6"></a><span class="dt">level1.column.name =</span> <span class="st">&quot;level1.ID&quot;</span>,</span>
<span id="cb70-7"><a href="#cb70-7"></a><span class="dt">level2.column.name =</span> <span class="st">&quot;level2.ID&quot;</span>,</span>
<span id="cb70-8"><a href="#cb70-8"></a><span class="dt">level.combinations =</span> <span class="kw">list</span>(FirstComboToUse, SecondComboToUse),</span>
<span id="cb70-9"><a href="#cb70-9"></a><span class="dt">level.combinations.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Signal 1 + 2 + 3&quot;</span>, <span class="st">&quot;Signal 3 + 4&quot;</span>),</span>
<span id="cb70-10"><a href="#cb70-10"></a><span class="dt">sampling_frequency =</span> <span class="dv">100</span>,</span>
<span id="cb70-11"><a href="#cb70-11"></a><span class="dt">single.bin.boundary =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>),</span>
<span id="cb70-12"><a href="#cb70-12"></a><span class="dt">integration.or.dominant.freq =</span> <span class="st">&quot;integration&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="co">#Kruskal-Wallis test results</span></span>
<span id="cb72-2"><a href="#cb72-2"></a>integration.compare.res2[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  vals.to.compare.combined by combo.labels.combined
## Kruskal-Wallis chi-squared = 4.9091, df = 1, p-value = 0.02672</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="co">#Values used in Kruskal-Wallis test</span></span>
<span id="cb74-2"><a href="#cb74-2"></a>integration.compare.res2[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>##    vals.to.compare.combined combo.labels.combined
## 1               0.002000248      Signal 1 + 2 + 3
## 2               0.008000115      Signal 1 + 2 + 3
## 3               0.008000115      Signal 1 + 2 + 3
## 4               0.008000115      Signal 1 + 2 + 3
## 5               0.008000115      Signal 1 + 2 + 3
## 6               0.008000115      Signal 1 + 2 + 3
## 7               0.008000115      Signal 1 + 2 + 3
## 8               0.008000115      Signal 1 + 2 + 3
## 9               0.008000115      Signal 1 + 2 + 3
## 10              0.008000115      Signal 1 + 2 + 3
## 11              0.002000248      Signal 1 + 2 + 3
## 12              0.002000248          Signal 3 + 4
## 13              0.002000248          Signal 3 + 4</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="co">#Dominant Frequency---------------------------------------------------------------------</span></span>
<span id="cb76-2"><a href="#cb76-2"></a></span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="co">#Compare dominant frequency P-value should not indicate</span></span>
<span id="cb76-4"><a href="#cb76-4"></a><span class="co">#significant difference</span></span>
<span id="cb76-5"><a href="#cb76-5"></a>integration.compare.res3 &lt;-<span class="st"> </span><span class="kw">SingleBinPSDIntegrationOrDominantFreqComparison</span>(</span>
<span id="cb76-6"><a href="#cb76-6"></a><span class="dt">list.of.windows =</span> windows,</span>
<span id="cb76-7"><a href="#cb76-7"></a><span class="dt">name.of.col.containing.time.series =</span> <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb76-8"><a href="#cb76-8"></a><span class="dt">level1.column.name =</span> <span class="st">&quot;level1.ID&quot;</span>,</span>
<span id="cb76-9"><a href="#cb76-9"></a><span class="dt">level2.column.name =</span> <span class="st">&quot;level2.ID&quot;</span>,</span>
<span id="cb76-10"><a href="#cb76-10"></a><span class="dt">level.combinations =</span> <span class="kw">list</span>(FirstComboToUse, SecondComboToUse),</span>
<span id="cb76-11"><a href="#cb76-11"></a><span class="dt">level.combinations.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Signal 1 + 2 + 3&quot;</span>, <span class="st">&quot;Signal 3 + 4&quot;</span>),</span>
<span id="cb76-12"><a href="#cb76-12"></a><span class="dt">sampling_frequency =</span> <span class="dv">100</span>,</span>
<span id="cb76-13"><a href="#cb76-13"></a><span class="dt">x_start =</span> <span class="dv">0</span>,</span>
<span id="cb76-14"><a href="#cb76-14"></a><span class="dt">x_end =</span> <span class="dv">10</span>,</span>
<span id="cb76-15"><a href="#cb76-15"></a><span class="dt">x_increment =</span> <span class="fl">0.01</span>,</span>
<span id="cb76-16"><a href="#cb76-16"></a><span class="dt">integration.or.dominant.freq =</span> <span class="st">&quot;dominant_freq&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co">#Kruskal-Wallis test results</span></span>
<span id="cb78-2"><a href="#cb78-2"></a>integration.compare.res3[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  vals.to.compare.combined by combo.labels.combined
## Kruskal-Wallis chi-squared = 2.0083, df = 1, p-value = 0.1564</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="co">#Values used in Kruskal-Wallis test</span></span>
<span id="cb80-2"><a href="#cb80-2"></a>integration.compare.res3[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>##    vals.to.compare.combined combo.labels.combined
## 1                         1      Signal 1 + 2 + 3
## 2                         1      Signal 1 + 2 + 3
## 3                         1      Signal 1 + 2 + 3
## 4                         1      Signal 1 + 2 + 3
## 5                         1      Signal 1 + 2 + 3
## 6                         1      Signal 1 + 2 + 3
## 7                         1      Signal 1 + 2 + 3
## 8                         1      Signal 1 + 2 + 3
## 9                         1      Signal 1 + 2 + 3
## 10                        1      Signal 1 + 2 + 3
## 11                        2      Signal 1 + 2 + 3
## 12                        2          Signal 3 + 4
## 13                        1          Signal 3 + 4</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co">#Compare dominant frequency P-value should indicate</span></span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="co">#significant difference</span></span>
<span id="cb82-3"><a href="#cb82-3"></a>integration.compare.res4 &lt;-<span class="st"> </span><span class="kw">SingleBinPSDIntegrationOrDominantFreqComparison</span>(</span>
<span id="cb82-4"><a href="#cb82-4"></a><span class="dt">list.of.windows =</span> windows,</span>
<span id="cb82-5"><a href="#cb82-5"></a><span class="dt">name.of.col.containing.time.series =</span> <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb82-6"><a href="#cb82-6"></a><span class="dt">level1.column.name =</span> <span class="st">&quot;level1.ID&quot;</span>,</span>
<span id="cb82-7"><a href="#cb82-7"></a><span class="dt">level2.column.name =</span> <span class="st">&quot;level2.ID&quot;</span>,</span>
<span id="cb82-8"><a href="#cb82-8"></a><span class="dt">level.combinations =</span> <span class="kw">list</span>(SecondComboToUse, ThirdComboToUse),</span>
<span id="cb82-9"><a href="#cb82-9"></a><span class="dt">level.combinations.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Signal 3 + 4&quot;</span>, <span class="st">&quot;Signal 5&quot;</span>),</span>
<span id="cb82-10"><a href="#cb82-10"></a><span class="dt">sampling_frequency =</span> <span class="dv">100</span>,</span>
<span id="cb82-11"><a href="#cb82-11"></a><span class="dt">x_start =</span> <span class="dv">0</span>,</span>
<span id="cb82-12"><a href="#cb82-12"></a><span class="dt">x_end =</span> <span class="dv">10</span>,</span>
<span id="cb82-13"><a href="#cb82-13"></a><span class="dt">x_increment =</span> <span class="fl">0.01</span>,</span>
<span id="cb82-14"><a href="#cb82-14"></a><span class="dt">integration.or.dominant.freq =</span> <span class="st">&quot;dominant_freq&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="co">#Kruskal-Wallis test results</span></span>
<span id="cb84-2"><a href="#cb84-2"></a>integration.compare.res4[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  vals.to.compare.combined by combo.labels.combined
## Kruskal-Wallis chi-squared = 5.8333, df = 1, p-value = 0.01573</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="co">#Values used in Kruskal-Wallis test</span></span>
<span id="cb86-2"><a href="#cb86-2"></a>integration.compare.res4[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>##   vals.to.compare.combined combo.labels.combined
## 1                        2          Signal 3 + 4
## 2                        1          Signal 3 + 4
## 3                        5              Signal 5
## 4                        5              Signal 5
## 5                        5              Signal 5
## 6                        5              Signal 5
## 7                        5              Signal 5</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
